(function(){"use strict";var e={8286:function(e,t,i){var s=i(5471),a=i(5668),n=i(301),o=i(5322),r=i(2367),l=function(){var e=this,t=e._self._c;return t(a.A,[t(n.A,{attrs:{app:"",color:"primary",dark:""}},[t(r.sw,[e._v("Festa Junina Leme 2025")])],1),t(o.A,{staticClass:"background"},[e.step===e.steps.START_WAITING?t("StartWaiting",{on:{next:function(t){e.step=e.steps.REGISTER}}}):e._e(),e.step===e.steps.REGISTER?t("StartForm",{on:{gotoStep:e.handleGotoStep,next:function(t){e.step=e.steps.QUEUE}}}):e._e(),[e.steps.QUEUE,e.steps.SELECTION].includes(e.step)?t("ResourceList",{on:{next:function(t){e.step=e.steps.PAYMENT},timeExpired:function(t){e.step=e.steps.SELECTION_EXPIRED}}}):e._e(),e.step===e.steps.PAYMENT?t("PaymentStep",{on:{next:function(t){e.step=e.steps.PAID},timeExpired:function(t){e.step=e.steps.PAYMENT_EXPIRED}}}):e._e(),e.step===e.steps.PAID?t("PurchaseFinished"):e._e(),[e.steps.PAYMENT_EXPIRED,e.steps.SELECTION_EXPIRED].includes(e.step)?t("TimeExpired",{attrs:{step:e.step}}):e._e()],1)],1)},c=[],u=(i(8111),i(116),i(3449)),d=function(){var e=this,t=e._self._c;return t(u.A,{attrs:{fluid:"","fill-height":""}},[e.loaded?null!=e.remainingSeconds?t("CountdownTimer",{ref:"timer",attrs:{"initial-time":e.remainingSeconds,message:"O cadastro para seleção das mesas começará em:"}}):e._e():t("FullscreenLoader")],1)},m=[],h=i(1554),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"fullscreen-loader"},[t(h.A,{attrs:{indeterminate:"",size:"64",color:"primary"}})],1)},f=[],g={},v=g,_=i(1656),S=(0,_.A)(v,p,f,!1,null,"160064d0",null),y=S.exports,A=i(5835),b=i(1484),T=i(2938),E=function(){var e=this,t=e._self._c;return t(b.A,{staticClass:"countdown-timer py-0",attrs:{outlined:""}},[t(T.OQ,{staticClass:"text-center py-0"},[e._v(" "+e._s(e.message)+" "),t("div",{staticClass:"time-display text-h5 font-weight-bold"},[e._v(" "+e._s(e.formattedMinutes)+":"+e._s(e.formattedSeconds)+" ")]),e.showControls?t(T.SL,{staticClass:"justify-center"},[t(A.A,{attrs:{color:"primary",disabled:e.remainingTime<=0},on:{click:e.toggleTimer}},[e._v(" "+e._s(e.isRunning?"Pause":"Start")+" ")]),t(A.A,{attrs:{color:"secondary",disabled:e.remainingTime===e.initialTime},on:{click:e.resetTimer}},[e._v(" Reset ")])],1):e._e()],1)],1)},C=[],x={name:"CountdownTimer",props:{initialTime:{type:Number,required:!0,validator:e=>e>=0},showControls:{type:Boolean,default:!1},autoStart:{type:Boolean,default:!1},message:{type:String}},data(){return{remainingTime:this.initialTime,timer:null,isRunning:!1}},computed:{formattedMinutes(){const e=Math.floor(this.remainingTime/60);return e.toString().padStart(2,"0")},formattedSeconds(){const e=this.remainingTime%60;return e.toString().padStart(2,"0")},timeWarning(){return this.remainingTime<=10},timeCritical(){return this.remainingTime<=5}},watch:{initialTime(e){this.resetTimer(e)}},mounted(){this.autoStart&&this.startTimer()},beforeDestroy(){this.clearTimer()},methods:{startTimer(){this.clearTimer(),this.remainingTime>0&&(this.isRunning=!0,this.timer=setInterval((()=>{this.remainingTime-=1,this.remainingTime<=0&&(this.remainingTime=0,this.clearTimer(),this.$emit("timer-end"))}),1e3))},pauseTimer(){this.clearTimer(),this.isRunning=!1},toggleTimer(){this.isRunning?this.pauseTimer():this.startTimer()},resetTimer(e=this.initialTime){this.pauseTimer(),this.remainingTime=e,this.$emit("timer-reset")},clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},addTime(e){this.remainingTime+=e,!this.isRunning&&this.remainingTime>0&&this.startTimer()},setTime(e){this.resetTimer(e)}}},I=x,k=(0,_.A)(I,E,C,!1,null,"376f5fd4",null),P=k.exports,R={name:"StartWaiting",components:{FullscreenLoader:y,CountdownTimer:P},data:function(){return{loaded:!1,remainingSeconds:null,interval:null}},mounted:async function(){await this.checkIfStarted(),this.startPolling()},beforeDestroy:function(){this.stopPolling()},methods:{checkIfStarted:async function(){try{const e=await this.$axios.post("/state/getStarted");null!=e.data.segundos_ate_liberacao&&(parseInt(e.data.segundos_ate_liberacao,10)<=0?(this.stopPolling(),this.$emit("next")):(this.loaded=!0,this.remainingSeconds=e.data.segundos_ate_liberacao,this.$nextTick((()=>{this.$refs.timer.startTimer()}))))}catch(e){console.error(e)}},startPolling:function(){null==this.interval&&(this.interval=window.setInterval(this.checkIfStarted,5e3))},stopPolling:function(){null!=this.interval&&(window.clearInterval(this.interval),this.interval=null)}}},w=R,$=(0,_.A)(w,d,m,!1,null,null,null),N=$.exports,O=i(4414),D=i(2413),L=i(9483),q=i(174),V=i(2756),M=i(1034),j=i(2494),F=function(){var e=this,t=e._self._c;return t(u.A,{staticClass:"d-flex align-center",staticStyle:{"justify-content":"space-around"},attrs:{"fill-height":"",fluid:""}},[e.loaded?e._e():t("FullscreenLoader"),t("div",{staticStyle:{width:"100%"}},[t(b.A,{staticClass:"mt-n10",staticStyle:{width:"100%"}},[t(T.ri,[e._v(" "+e._s(e.cardTitle)+" ")]),t(T.OQ,[t(q.A,{ref:"form",attrs:{"lazy-validation":""}},[e.isStudentStep?[t("p",[e._v("Para cada aluno identificado, você poderá comprar até 2 mesas")]),t(V.A,{attrs:{align:"center",justify:"center"}},[t(O.A,[t(j.A,{directives:[{name:"mask",rawName:"v-mask",value:"###########",expression:"'###########'"}],attrs:{label:"RM do aluno",required:"",rules:e.validationEnabled?[e.rules.required]:[],clearable:""},model:{value:e.studentCode,callback:function(t){e.studentCode=t},expression:"studentCode"}})],1),t(O.A,{attrs:{cols:"5"}},[t(A.A,{attrs:{color:"primary",outlined:""},on:{click:e.checkStudent}},[e._v("Adicionar")])],1)],1),t(L.A),t("p",{staticClass:"mt-4"},[e._v(e._s(e.informedStudentsText))])]:[t(j.A,{attrs:{label:"Nome",required:"",rules:e.validationEnabled?[e.rules.required]:[],clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(j.A,{directives:[{name:"mask",rawName:"v-mask",value:"###.###.###-##",expression:"'###.###.###-##'"}],attrs:{label:"CPF",required:"",rules:e.validationEnabled?[e.rules.required,e.isValidCPF]:[],clearable:""},model:{value:e.identification,callback:function(t){e.identification=t},expression:"identification"}}),t(j.A,{attrs:{label:"Email",required:"",rules:e.validationEnabled?[e.rules.required,e.rules.validEmail]:[],clearable:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})]],2)],1),t(T.SL,[e.isStudentStep?t(A.A,{attrs:{color:"accent",outlined:""},on:{click:e.back}},[e._v("Voltar")]):e._e(),t(M.A),t(A.A,{attrs:{color:"accent"},on:{click:function(t){e.clearConfirmationDialog=!0}}},[e._v("Limpar")]),t(A.A,{attrs:{disabled:e.isStudentStep&&!e.students.length,color:"primary"},on:{click:e.handleAction}},[e._v("Próximo")])],1)],1)],1),t(D.A,{model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(b.A,[t(T.ri,[e._v(" Aluno encontrado ")]),t(T.OQ,[e._v(' Encontramos o aluno "'+e._s(e.foundStudentName)+'". Confirma a adição? ')]),t(T.SL,[t(M.A),t(A.A,{attrs:{outline:"",color:"accent"},on:{click:e.closeStudentDialog}},[e._v("Voltar")]),t(A.A,{attrs:{color:"primary"},on:{click:e.confirmStudent}},[e._v("Confirmar")])],1)],1)],1),t(D.A,{model:{value:e.confirmationDialog,callback:function(t){e.confirmationDialog=t},expression:"confirmationDialog"}},[t(b.A,[t(T.ri,[e._v("Confirmação")]),t(T.OQ,[t("p",[e._v(e._s(e.informedStudentsText)+" Portanto você poderá escolher até "),t("b",{staticStyle:{color:"#000084"}},[e._v(e._s(e.maxTables)+" mesas.")])]),t("p",[e._v("Aviso: após confirmar, não será possível voltar.")])]),t(T.SL,[t(M.A),t(A.A,{attrs:{outline:"",color:"accent"},on:{click:function(t){e.confirmationDialog=!1}}},[e._v("Voltar")]),t(A.A,{attrs:{color:"primary"},on:{click:e.save}},[e._v("Confirmar")])],1)],1)],1),t(D.A,{model:{value:e.clearConfirmationDialog,callback:function(t){e.clearConfirmationDialog=t},expression:"clearConfirmationDialog"}},[t(b.A,[t(T.ri,[e._v("Confirmação")]),t(T.OQ,[e.isStudentStep?t("p",[e._v("Remover alunos selecionados?")]):t("p",[e._v("Limpar campos preenchidos?")])]),t(T.SL,[t(M.A),t(A.A,{attrs:{outline:"",color:"accent"},on:{click:function(t){e.clearConfirmationDialog=!1}}},[e._v("Voltar")]),t(A.A,{attrs:{color:"primary"},on:{click:e.clear}},[e._v("Sim")])],1)],1)],1)],1)},Q=[],U=(i(4114),i(1701),i(1303)),X={name:"StartForm",components:{FullscreenLoader:y},data:function(){return{name:null,identification:null,email:null,uuid:null,loaded:!1,validationEnabled:!1,isStudentStep:!1,students:[],studentCode:null,foundStudentName:null,foundStudentId:null,foundStudentCode:null,dialog:!1,confirmationDialog:!1,clearConfirmationDialog:!1,rules:{required:e=>!!e&&e.trim().length>=3||"Digite ao menos 3 caracteres",validEmail:e=>!!e&&/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(e)||"E-mail inválido"}}},mounted:function(){this.load()},computed:{cardTitle:function(){return this.isStudentStep?"Informar Aluno(s)":"Dados para pagamento"},informedStudentsText:function(){return this.students.length?1===this.students.length?"Você informou o RM do aluno "+this.students.map((e=>`"${e.name}"`)).join(", ")+".":"Você informou o RM dos alunos "+this.students.map((e=>`"${e.name}"`)).join(", ")+".":"Identifique ao menos um aluno para continuar."},maxTables:function(){return 2*this.students.length}},methods:{load:async function(){if(this.uuid=localStorage.getItem("uuid_usuario"),this.uuid){let e;try{e=await this.$axios.post("/user/get",{uuid_usuario:this.uuid})}catch(t){return console.error(t),void this.$toasted.error("Não foi possível consultar o servidor")}if(e.data?.user?.id_etapa)return void this.$emit("gotoStep",e.data?.user?.id_etapa)}const e=(0,U.A)();localStorage.setItem("uuid_usuario",e),this.uuid=e,this.loaded=!0},handleAction:function(){this.isStudentStep?this.confirmationDialog=!0:(this.validationEnabled=!0,this.$nextTick((async()=>{this.$refs.form.validate()&&(this.isStudentStep=!0,this.$refs.form.resetValidation(),this.validationEnabled=!1)})))},save:async function(){this.loaded=!1;try{const e=await this.$axios.post("/user/create",{uuid_usuario:this.uuid,numero_identificacao:this.identification,tipo_identificacao:"CPF",email:this.email,nome:this.name,codigos_alunos:this.students.map((e=>e.studentCode))}),t=e.data.token;localStorage.setItem("token",t),this.$toasted.success("Dados salvos com sucesso!")}catch(e){return void(null!=e.response?.data?.message?this.$toasted.error(e.response.data.message):this.$toasted.error("Ocorreu um erro inesperado!"))}finally{this.loaded=!0}this.$emit("next")},back:function(){this.isStudentStep=!1},clear:function(){this.isStudentStep?(this.students=[],this.studentCode=null,this.clearConfirmationDialog=!1):(this.identification=null,this.email=null,this.name=null,this.$refs.form.resetValidation(),this.validationEnabled=!1,this.clearConfirmationDialog=!1)},isValidCPF:function(e){if(null==e)return"CPF inválido";const t=e.replace(/[^\d]+/g,"");if(11!==t.length||/^(\d)\1+$/.test(t))return"CPF inválido";let i=0;for(let a=0;a<9;a++)i+=parseInt(t.charAt(a))*(10-a);let s=10*i%11;if(10!==s&&11!==s||(s=0),s!==parseInt(t.charAt(9)))return"CPF inválido";i=0;for(let a=0;a<10;a++)i+=parseInt(t.charAt(a))*(11-a);return s=10*i%11,10!==s&&11!==s||(s=0),s===parseInt(t.charAt(10))||"CPF inválido"},checkStudent:async function(){this.validationEnabled=!0,this.$nextTick((async()=>{if(!this.$refs.form.validate())return;if(this.students.find((e=>e.studentCode===this.studentCode.trim())))return void this.$toasted.error("Você já adicionou esse aluno");let e;try{e=await this.$axios.post("/student/get",{codigo_aluno:this.studentCode.trim()})}catch(t){return 404===t.status?this.$toasted.error("Aluno não encontrado, por favor revise o código digitado."):400===t.status?this.$toasted.error("O aluno informado já está vinculado a outro usuário."):(console.error(t),this.$toasted.error("Erro inesperado ao consultar aluno"))}this.foundStudentName=e.data.aluno.nome,this.foundStudentId=e.data.aluno.id_aluno,this.foundStudentCode=e.data.aluno.codigo,this.dialog=!0}))},closeStudentDialog:function(){this.dialog=!1,this.$nextTick((()=>{this.foundStudentName=null,this.foundStudentCode=null}))},confirmStudent:function(){this.students.push({name:this.foundStudentName,studentId:this.foundStudentId,studentCode:this.foundStudentCode}),this.$nextTick((()=>{this.foundStudentId=null,this.closeStudentDialog(),this.$toasted.success("Aluno adicionado!")}))}}},B=X,z=(0,_.A)(B,F,Q,!1,null,null,null),Y=z.exports,G=i(8143),W=i(6930),J=function(){var e=this,t=e._self._c;return t(u.A,{attrs:{fluid:"","fill-height":""}},[t(b.A,{staticStyle:{width:"100%"}},[t(T.ri,{staticClass:"py-1"},[t(V.A,{attrs:{justify:"center",align:"center"}},[e.step===e.steps.SELECTION&&null!=e.remainingSeconds?t(O.A,[t("countdown-timer",{ref:"timer",attrs:{"initial-time":e.remainingSeconds,message:"Tempo para escolher: "}})],1):t(O.A,{staticStyle:{"min-width":"170px",display:"flex","align-content":"center","justify-content":"center"}},[t("span",{staticClass:"mr-2"},[e._v(e._s(e.getTitle))]),e.step===e.steps.QUEUE?t(h.A,{attrs:{indeterminate:"",color:"primary"}}):e._e()],1)],1)],1),t(T.OQ,[t("div",{staticClass:"table-map"},[t("div",{staticStyle:{"grid-area":"1 / 14 / span 1 / span 7",display:"grid","place-items":"center"}},[t("h1",[e._v("Cantina e bar")])]),t("div",{staticStyle:{"grid-area":"3 / 21 / span 9 / span 1",display:"grid","place-items":"center"}},[t("h1",{staticStyle:{"writing-mode":"vertical-rl"}},[e._v("Palco da quadra / caixa")])]),t("div",{staticClass:"border",staticStyle:{"grid-area":"2 / 1 / 12 / 21",margin:"-10px"}}),e._l(e.positionedResources,(function(i){return t("NumberToggle",{key:i.id_recurso,style:e.getItemStyle(i),attrs:{value:i.id_recurso,number:parseInt(i.nome_recurso_short,10),state:e.getResourceState(i),readonly:e.step===e.steps.QUEUE},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})})),t("div",{staticClass:"palco border"},[t("div",{staticStyle:{"grid-area":"1 / 1 / span 4 / span 7",display:"grid","place-items":"center"}},[t("h1",[e._v("Apresentações")])]),t("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 1 / span 1 / span 3",display:"grid","place-items":"center"}},[t("h2",[e._v("Fotos")])]),t("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 5 / span 1 / span 3",display:"grid","place-items":"center"}},[t("h2",[e._v("Fotos")])])]),t("div",{staticStyle:{"grid-area":"12 / 1 / 12 / 7"}},[t("h1",{staticStyle:{"text-align":"left"}},[e._v("Entrada")]),t(W.A,{staticStyle:{transform:"scaleX(4) scaleY(1)","transform-origin":"left"}},[e._v("mdi-arrow-right-bold")])],1),t("div",{staticStyle:{"grid-area":"13 / 1 / 13 / 21",display:"grid","place-items":"center"}},[t("h1",{staticStyle:{"text-align":"left"}},[e._v("Arquibancada")])])],2)])],1),t(D.A,{model:{value:e.informationDialog,callback:function(t){e.informationDialog=t},expression:"informationDialog"}},[t(b.A,[t(T.ri,[e._v(" Seleção de mesas ")]),t(T.OQ,[t("ul",[t("li",[e._v("Para navegar pelo mapa, basta arrastar a tela")]),t("li",[e._v("Quando chegar a sua vez na fila, você poderá clicar nas mesas para escolhê-las")]),t("li",[e._v("Fique atento ao "),t("b",[e._v("tempo limite")]),e._v(" para escolher as mesas. Quando for sua vez, um contador aparecerá no topo da tela.")]),t("li",[e._v('Quando tiver escolhido suas mesas, basta clicar no botão "Comprar mesas" na parte inferior da tela')])])]),t(T.SL,[t(M.A),t(A.A,{attrs:{color:"primary"},on:{click:function(t){e.informationDialog=!1}}},[e._v("OK")])],1)],1)],1),t(G.A,{staticStyle:{"justify-content":"end",gap:"5px"},attrs:{color:"primary",app:""}},[e.step===e.steps.SELECTION?[t("span",{staticStyle:{color:"background"}},[e._v(e._s(e.totalPriceLabel))]),t(M.A),t(A.A,{attrs:{color:"background"},on:{click:function(t){e.informationDialog=!0}}},[e._v("Ajuda")]),t(A.A,{attrs:{color:"background",loading:e.buttonLoading},on:{click:e.requestPickedResources}},[e._v(e._s(e.buyButtonLabel))])]:t(A.A,{attrs:{color:"background"},on:{click:function(t){e.informationDialog=!0}}},[e._v("Ajuda")])],2)],1)},K=[],H=(i(2489),i(8237),function(){var e=this,t=e._self._c;return t("div",{staticClass:"numbered-checkbox",class:{checked:e.isChecked,"disabled-cursor":1===e.state,"disabled-light":2===e.state,"disabled-dark":3===e.state},on:{click:e.toggle}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.internalValue,expression:"internalValue"}],staticClass:"hidden-checkbox",attrs:{type:"checkbox",disabled:e.disabled,readonly:e.readonly},domProps:{value:e.value,checked:Array.isArray(e.internalValue)?e._i(e.internalValue,e.value)>-1:e.internalValue},on:{change:[function(t){var i=e.internalValue,s=t.target,a=!!s.checked;if(Array.isArray(i)){var n=e.value,o=e._i(i,n);s.checked?o<0&&(e.internalValue=i.concat([n])):o>-1&&(e.internalValue=i.slice(0,o).concat(i.slice(o+1)))}else e.internalValue=a},e.handleChange]}}),t("span",{staticClass:"checkbox-number"},[e._v(e._s(e.number))])])}),Z=[],ee={name:"NumberedCheckbox",model:{prop:"modelValue",event:"change"},props:{value:{type:[String,Number,Boolean,Object],required:!0},modelValue:{type:[Array,Boolean],default:()=>[]},number:{type:Number,required:!0},state:{type:Number,required:!0},readonly:{type:Boolean,default:!1}},computed:{internalValue:{get(){return this.modelValue},set(e){this.$emit("change",e)}},isChecked(){return Array.isArray(this.modelValue)?this.modelValue.includes(this.value):this.modelValue},disabled(){return this.state>0}},methods:{toggle(){if(!this.disabled)if(Array.isArray(this.modelValue)){const e=[...this.modelValue],t=e.indexOf(this.value);-1===t?e.push(this.value):e.splice(t,1),this.$emit("change",e)}else this.$emit("change",!this.modelValue)},handleChange(e){this.$emit("change",e.target.checked)}}},te=ee,ie=(0,_.A)(te,H,Z,!1,null,"25509e80",null),se=ie.exports,ae={name:"ResourceList",components:{NumberToggle:se,CountdownTimer:P},data:function(){return{interval:null,resourceInterval:null,step:1,steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5},resources:[],unavailableResources:[],selected:[],qr_code:null,qr_code_base64:null,buttonLoading:!1,tableLimit:0,remainingSeconds:null,informationDialog:!0,shownAlert:!1}},mounted:function(){this.startPolling()},beforeDestroy:function(){this.stopPollingState(),this.stopPollingResources()},computed:{getTitle:function(){return this.step===this.steps.QUEUE?"Aguarde, você está na fila.":this.step===this.steps.SELECTION?"Tempo para escolher:":null},positionedResources(){return this.resources.filter((e=>null!=e.column_start))},getMySelectedResourceIds(){return this.selected.filter((e=>{const t=this.resources.find((t=>t.id_recurso===e));return 1===t.id_status_recurso||1===t.solicitado_por_mim}))},buyButtonLabel:function(){return 1===this.getMySelectedResourceIds.length?"Comprar mesa":this.getMySelectedResourceIds.length>1?`Comprar ${this.getMySelectedResourceIds.length} mesas`:"Comprar mesas"},totalPriceLabel:function(){const e=this.getMySelectedResourceIds.reduce(((e,t)=>e+Number(this.resources.find((e=>e.id_recurso===t)).valor)),0);return"Total: R$ "+e.toFixed(2)},resourceLimitReached:function(){return this.getMySelectedResourceIds.length>=this.tableLimit}},methods:{startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,5e3)),this.resourceInterval||(this.getResources(),this.resourceInterval=window.setInterval(this.getResources,1e4))},stopPollingState:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},stopPollingResources:function(){this.resourceInterval&&(window.clearInterval(this.resourceInterval),this.resourceInterval=null)},getState:async function(){let e;try{e=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}const t=e.data.usuario;return parseInt(t.segundos_restantes_selecao)<0?(this.stopPollingResources(),this.stopPollingState(),void this.$emit("timeExpired")):1===t.minha_vez&&this.step===this.steps.QUEUE?(this.startSelectionStep(),this.tableLimit=parseInt(t.limite_mesas,10),this.remainingSeconds=t.segundos_restantes_selecao,this.$nextTick((()=>{this.$refs.timer.startTimer()})),void this.$toasted.success("Chegou sua vez na fila! Por favor selecione suas mesas.")):void(1===t.minha_vez&&this.step===this.steps.SELECTION&&(this.remainingSeconds=t.segundos_restantes_selecao,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error('Atenção! Você tem menos de um minuto para terminar de selecionar suas mesas. Termine a seleção e clique em "Comprar mesas" dentro do tempo limite para garantir suas mesas.',{duration:8e3}),this.shownAlert=!0),this.$nextTick((()=>{this.$refs.timer.startTimer()}))))},getResources:async function(){let e;try{e=await this.$axios.post("/resource")}catch(t){return console.error(t),void this.$toasted.error("Não foi possível consultar os recursos")}this.resources=e.data.recursos,this.selected=this.resources.filter((e=>1!==e.id_status_recurso)).map((e=>e.id_recurso))},startSelectionStep:function(){this.stopPollingResources(),this.step=this.steps.SELECTION,this.getResources()},requestPickedResources:async function(){if(!this.getMySelectedResourceIds)return void this.$toasted.error("É necessário escolher ao menos uma mesa");let e;this.buttonLoading=!0;try{e=await this.$axios.post("/resource/request",{resource_ids:this.getMySelectedResourceIds})}catch(t){return console.error(t),void this.$toasted.error("Não foi possível solicitar os recursos")}finally{this.buttonLoading=!1}this.stopPollingResources(),this.stopPollingState(),this.$emit("next",e)},getResourceState:function(e){return 1===e.id_status_recurso||e.solicitado_por_mim?this.step===this.steps.QUEUE?1:this.resourceLimitReached&&-1===this.selected.findIndex((t=>t===e.id_recurso))?2:0:3},getItemStyle:function(e){return null==e.row_start||null==e.row_end||null==e.column_start||null==e.column_end?null:{"grid-row":e.row_start+1+" / span "+(e.row_end-e.row_start+1),"grid-column":e.column_start+" / span "+(e.column_end-e.column_start+1)}}}},ne=ae,oe=(0,_.A)(ne,J,K,!1,null,"e0f8ae48",null),re=oe.exports,le=i(5420),ce=function(){var e=this,t=e._self._c;return t(u.A,{attrs:{fluid:"","fill-height":""}},[t(b.A,[t(T.ri,[t(V.A,{attrs:{justify:"center",align:"center"}},[t(O.A,{staticClass:"keep-words"},[e._v(" Pague R$"+e._s(e.payment_value.toFixed(2))+" via PIX ")]),null!=e.remainingSeconds?t(O.A,[t("countdown-timer",{ref:"timer",attrs:{"initial-time":e.remainingSeconds,message:"Tempo restante"}})],1):e._e()],1)],1),t(T.OQ,[t("div",{staticClass:"mb-2"},[e._v("Escaneie o código QR:")]),e.qr_code_base64?t(le.A,{attrs:{src:`data:image/png;base64,${e.qr_code_base64}`}}):e._e(),t(L.A,{staticClass:"mb-1"}),t("div",{staticClass:"mb-2"},[e._v("Ou use o código abaixo:")]),t(j.A,{attrs:{id:"textToCopy",readonly:"",value:e.qr_code,"append-icon":"mdi-content-copy"},on:{"click:append":e.copyCode}}),t(V.A,{attrs:{align:"center",justify:"center"}},[t(O.A,{staticStyle:{display:"grid","place-items":"center"},attrs:{cols:"12"}},[t(A.A,{attrs:{color:"primary"},on:{click:e.copyCode}},[e._v("Copiar código")])],1)],1),t(V.A,[t(O.A,[t("p",[e._v("Você será redirecionado automaticamente assim que o pagamento for aprovado.")])])],1)],1)],1)],1)},ue=[],de={name:"PaymentStep",components:{CountdownTimer:P},data:function(){return{qr_code:null,qr_code_base64:null,payment_value:null,interval:null,remainingSeconds:null,shownAlert:!1}},mounted:function(){this.loadPayment(),this.startPolling()},beforeDestroy:function(){this.stopPolling()},methods:{loadPayment:async function(){const e=await this.$axios.post("/payment");if(e.data.pagamento){const{qr_code:t,qr_code_base64:i,valor:s}=e.data.pagamento;this.qr_code=t,this.qr_code_base64=i,this.payment_value=Number(s)}},startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,5e3))},stopPolling:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},getState:async function(){let e;try{e=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}const t=e.data.usuario;return 4===t.id_etapa?(this.stopPolling(),void this.$emit("next")):parseInt(t.segundos_restantes_pagamento,10)<0?(this.stopPolling(),void this.$emit("timeExpired")):(this.remainingSeconds=t.segundos_restantes_pagamento,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error("Atenção! Você tem menos de um minuto para realizar o pagamento. Realize o pagamento dentro do tempo limite para garantir suas mesas.",{duration:8e3}),this.shownAlert=!0),void this.$nextTick((()=>{this.$refs.timer.startTimer()})))},copyCode:async function(){try{let e=document.querySelector("#textToCopy");e.select(),document.execCommand("copy")}catch(e){console.error(e),this.$toasted.error("Não foi possível copiar o código")}}}},me=de,he=(0,_.A)(me,ce,ue,!1,null,"32296880",null),pe=he.exports,fe=function(){var e=this,t=e._self._c;return t(u.A,{attrs:{fluid:"","fill-height":""}},[e.bookedResources.length?e._e():t("FullscreenLoader"),t(b.A,{staticStyle:{width:"100%"}},[t(T.ri,[e._v(" Compra finalizada ")]),t(T.OQ,[t("p",[e._v(e._s(e.getBookedResourcesText))])])],1)],1)},ge=[],ve={name:"PurchaseFinished",components:{FullscreenLoader:y},data:function(){return{bookedResources:[],headers:[{text:"Nome",value:"nome_recurso"}]}},computed:{getBookedResourcesText:function(){return this.bookedResources.length>1?"Mesas reservadas para você: "+this.bookedResources.map((e=>e.nome_recurso_short)).join(", "):"Mesa reservada para você: "+this.bookedResources.map((e=>e.nome_recurso_short)).join(", ")}},mounted:function(){this.loadBookedResources()},methods:{loadBookedResources:async function(){const e=await this.$axios.post("/resource/booked");e.data.recursos&&e.data.recursos.length?this.bookedResources=e.data.recursos:window.setTimeout(this.loadBookedResources,1e3)}}},_e=ve,Se=(0,_.A)(_e,fe,ge,!1,null,null,null),ye=Se.exports,Ae=function(){var e=this,t=e._self._c;return t(u.A,{attrs:{fluid:"","fill-height":""}},[t(b.A,{staticStyle:{width:"100%"}},[t(T.ri,[e._v(" Tempo expirado! ")]),t(T.OQ,[t("p",[e._v(e._s(e.getMessage))])])],1)],1)},be=[],Te={name:"TimeExpired",data:function(){return{steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6}}},props:{step:{type:Number,required:!0}},computed:{getMessage:function(){return this.step===this.steps.SELECTION_EXPIRED?"O tempo para escolher as mesas expirou":this.step===this.steps.PAYMENT_EXPIRED?"O tempo para pagamento expirou":null}}},Ee=Te,Ce=(0,_.A)(Ee,Ae,be,!1,null,null,null),xe=Ce.exports,Ie={name:"App",components:{StartWaiting:N,StartForm:Y,ResourceList:re,PaymentStep:pe,PurchaseFinished:ye,TimeExpired:xe},data:()=>({steps:{START_WAITING:-1,REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6},step:-1}),methods:{handleGotoStep:function(e){this.step=this.steps[Object.keys(this.steps).find((t=>this.steps[t]===e))]}}},ke=Ie,Pe=(0,_.A)(ke,l,c,!1,null,null,null),Re=Pe.exports,we=i(5868);s.Ay.use(we.A);var $e=new we.A({theme:{themes:{light:{primary:"#000084",secondary:"#e6e998",accent:"#d82621",error:"#d82621",background:"#fafafa"}}}}),Ne=i(5160),Oe=i.n(Ne),De=i(4335);const Le=De.A.create({baseURL:"https://f626-2804-14c-8181-82ba-adb2-1e16-2d25-8ae2.ngrok-free.app",timeout:1e4,headers:{"Content-Type":"application/json"}});Le.interceptors.request.use((e=>(e.headers["X-User-Uuid"]=localStorage.getItem("uuid_usuario"),e.headers["Authorization"]=localStorage.getItem("token"),e)));var qe=Le,Ve=i(9928),Me=i.n(Ve);s.Ay.config.productionTip=!1,s.Ay.prototype.$axios=qe,s.Ay.use(Oe(),{position:"bottom-center",duration:3e3,theme:"toasted-primary"}),s.Ay.use(Me()),new s.Ay({vuetify:$e,render:e=>e(Re)}).$mount("#app")}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,s,a,n){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],a=e[u][1],n=e[u][2];for(var r=!0,l=0;l<s.length;l++)(!1&n||o>=n)&&Object.keys(i.O).every((function(e){return i.O[e](s[l])}))?s.splice(l--,1):(r=!1,n<o&&(o=n));if(r){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[s,a,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var a,n,o=s[0],r=s[1],l=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var u=l(i)}for(t&&t(s);c<o.length;c++)n=o[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(u)},s=self["webpackChunklemefest"]=self["webpackChunklemefest"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[504],(function(){return i(8286)}));s=i.O(s)})();
//# sourceMappingURL=app.7aeb0b47.js.map