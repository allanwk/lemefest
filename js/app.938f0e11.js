(function(){"use strict";var t={7615:function(t,e,i){var s=i(5471),a=i(5668),o=i(301),n=i(5420),r=i(5322),l=i(1034),c=i(2367),u=function(){var t=this,e=t._self._c;return e(a.A,[e(o.A,{attrs:{app:"",color:"primary",dark:""}},[e(c.sw,[t._v("Festa Junina Leme 2025")]),e(l.A),e(n.A,{attrs:{src:"/colegio.png",contain:"",height:"40","max-width":"40"}})],1),e(r.A,{staticClass:"background"},[t.step===t.steps.START_WAITING?e("StartWaiting",{on:{next:function(e){t.step=t.steps.REGISTER}}}):t._e(),t.step===t.steps.REGISTER?e("StartForm",{attrs:{fromRestart:t.restart},on:{gotoStep:t.handleGotoStep,next:function(e){t.step=t.steps.QUEUE}}}):t._e(),[t.steps.QUEUE,t.steps.SELECTION].includes(t.step)?e("ResourceList",{on:{next:function(e){t.step=t.steps.PAYMENT},timeExpired:function(e){t.step=t.steps.SELECTION_EXPIRED}}}):t._e(),t.step===t.steps.PAYMENT?e("PaymentStep",{on:{next:function(e){t.step=t.steps.PAID},timeExpired:function(e){t.step=t.steps.PAYMENT_EXPIRED}}}):t._e(),t.step===t.steps.PAID?e("PurchaseFinished",{on:{restart:t.handleRestart}}):t._e(),[t.steps.PAYMENT_EXPIRED,t.steps.SELECTION_EXPIRED].includes(t.step)?e("TimeExpired",{attrs:{step:t.step},on:{restart:t.handleRestart}}):t._e()],1)],1)},d=[],m=(i(8111),i(116),i(3449)),h=function(){var t=this,e=t._self._c;return e(m.A,{attrs:{fluid:"","fill-height":""}},[t.loaded?null!=t.remainingSeconds?e("CountdownTimer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"O cadastro para seleção das mesas começará em:"}}):t._e():e("FullscreenLoader")],1)},p=[],f=i(1554),g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"fullscreen-loader"},[e(f.A,{attrs:{indeterminate:"",size:"64",color:"primary"}})],1)},v=[],_={},S=_,y=i(1656),A=(0,y.A)(S,g,v,!1,null,"160064d0",null),b=A.exports,E=i(5835),C=i(1484),T=i(2938),k=function(){var t=this,e=t._self._c;return e(C.A,{staticClass:"countdown-timer py-0",attrs:{outlined:""}},[e(T.OQ,{staticClass:"text-center py-0"},[t._v(" "+t._s(t.message)+" "),e("div",{staticClass:"time-display text-h5 font-weight-bold"},[t._v(" "+t._s(t.formattedMinutes)+":"+t._s(t.formattedSeconds)+" ")]),t.showControls?e(T.SL,{staticClass:"justify-center"},[e(E.A,{attrs:{color:"primary",disabled:t.remainingTime<=0},on:{click:t.toggleTimer}},[t._v(" "+t._s(t.isRunning?"Pause":"Start")+" ")]),e(E.A,{attrs:{color:"secondary",disabled:t.remainingTime===t.initialTime},on:{click:t.resetTimer}},[t._v(" Reset ")])],1):t._e()],1)],1)},x=[],I={name:"CountdownTimer",props:{initialTime:{type:Number,required:!0,validator:t=>t>=0},showControls:{type:Boolean,default:!1},autoStart:{type:Boolean,default:!1},message:{type:String}},data(){return{remainingTime:this.initialTime,timer:null,isRunning:!1}},computed:{formattedMinutes(){const t=Math.floor(this.remainingTime/60);return t.toString().padStart(2,"0")},formattedSeconds(){const t=this.remainingTime%60;return t.toString().padStart(2,"0")},timeWarning(){return this.remainingTime<=10},timeCritical(){return this.remainingTime<=5}},watch:{initialTime(t){this.resetTimer(t)}},mounted(){this.autoStart&&this.startTimer()},beforeDestroy(){this.clearTimer()},methods:{startTimer(){this.clearTimer(),this.remainingTime>0&&(this.isRunning=!0,this.timer=setInterval((()=>{this.remainingTime-=1,this.remainingTime<=0&&(this.remainingTime=0,this.clearTimer(),this.$emit("timer-end"))}),1e3))},pauseTimer(){this.clearTimer(),this.isRunning=!1},toggleTimer(){this.isRunning?this.pauseTimer():this.startTimer()},resetTimer(t=this.initialTime){this.pauseTimer(),this.remainingTime=t,this.$emit("timer-reset")},clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},addTime(t){this.remainingTime+=t,!this.isRunning&&this.remainingTime>0&&this.startTimer()},setTime(t){this.resetTimer(t)}}},R=I,P=(0,y.A)(R,k,x,!1,null,"376f5fd4",null),w=P.exports,$={name:"StartWaiting",components:{FullscreenLoader:b,CountdownTimer:w},data:function(){return{loaded:!1,remainingSeconds:null,interval:null}},mounted:async function(){await this.checkIfStarted(),this.startPolling()},beforeDestroy:function(){this.stopPolling()},methods:{checkIfStarted:async function(){try{const t=await this.$axios.post("/state/getStarted");null!=t.data.segundos_ate_liberacao&&(parseInt(t.data.segundos_ate_liberacao,10)<=0?(this.stopPolling(),this.$emit("next")):(this.loaded=!0,this.remainingSeconds=t.data.segundos_ate_liberacao,this.$nextTick((()=>{this.$refs.timer.startTimer()}))))}catch(t){console.error(t)}},startPolling:function(){null==this.interval&&(this.interval=window.setInterval(this.checkIfStarted,5e3))},stopPolling:function(){null!=this.interval&&(window.clearInterval(this.interval),this.interval=null)}}},D=$,N=(0,y.A)(D,h,p,!1,null,null,null),O=N.exports,L=i(4414),q=i(2413),V=i(9483),M=i(174),j=i(2756),U=i(2494),Q=function(){var t=this,e=t._self._c;return e(m.A,{staticClass:"d-flex align-center",staticStyle:{"justify-content":"space-around"},attrs:{"fill-height":"",fluid:""}},[t.loaded?t._e():e("FullscreenLoader"),e("div",{staticStyle:{width:"100%"}},[e(C.A,{staticClass:"mt-n10",staticStyle:{width:"100%"}},[e(T.ri,[t._v(" "+t._s(t.cardTitle)+" ")]),e(T.OQ,[e(M.A,{ref:"form",attrs:{"lazy-validation":""}},[t.isStudentStep?[e("p",[t._v("Para cada aluno identificado, você poderá comprar até 2 mesas")]),e(j.A,{attrs:{align:"center",justify:"center"}},[e(L.A,[e(U.A,{directives:[{name:"mask",rawName:"v-mask",value:"###########",expression:"'###########'"}],attrs:{label:"RM do aluno",required:"",rules:t.validationEnabled?[t.rules.required]:[],clearable:""},model:{value:t.studentCode,callback:function(e){t.studentCode=e},expression:"studentCode"}})],1),e(L.A,{attrs:{cols:"5"}},[e(E.A,{attrs:{color:"primary",outlined:""},on:{click:t.checkStudent}},[t._v("Adicionar")])],1)],1),e(V.A),e("p",{staticClass:"mt-4"},[t._v(t._s(t.informedStudentsText))])]:[e("p",[t._v("Por favor preencha corretamente. Precisamos desses dados para processar o pagamento via PIX.")]),e(U.A,{attrs:{label:"Nome",required:"",rules:t.validationEnabled?[t.rules.required]:[],clearable:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),e(U.A,{directives:[{name:"mask",rawName:"v-mask",value:"###.###.###-##",expression:"'###.###.###-##'"}],attrs:{label:"CPF",required:"",rules:t.validationEnabled?[t.rules.required,t.isValidCPF]:[],clearable:""},model:{value:t.identification,callback:function(e){t.identification=e},expression:"identification"}}),e(U.A,{attrs:{label:"Email",required:"",rules:t.validationEnabled?[t.rules.required,t.rules.validEmail]:[],clearable:""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})]],2)],1),e(T.SL,[e(l.A),e(E.A,{attrs:{color:"accent"},on:{click:t.startClearAction}},[t._v("Limpar")]),t.isStudentStep?e(E.A,{attrs:{disabled:t.isStudentStep&&!t.students.length,color:"primary"},on:{click:t.handleAction}},[t._v("Próximo")]):e(E.A,{attrs:{color:"primary"},on:{click:t.handleAction}},[t._v("Salvar")])],1)],1)],1),e(q.A,{model:{value:t.dataConfirmationDialog,callback:function(e){t.dataConfirmationDialog=e},expression:"dataConfirmationDialog"}},[e(C.A,[e(T.ri,[t._v("Os dados estão corretos?")]),e(T.OQ,[e("p",[t._v("Nome: "+t._s(t.name))]),e("p",[t._v("CPF: "+t._s(t.identification))]),e("p",[t._v("E-mail: "+t._s(t.email))]),e("b",[t._v("Verifique com cuidado, você não poderá alterá-los depois!")])]),e(T.SL,[e(l.A),e(E.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.dataConfirmationDialog=!1}}},[t._v("Voltar")]),e(E.A,{attrs:{color:"primary"},on:{click:t.confirmBasicData}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(C.A,[e(T.ri,[t._v(" Aluno encontrado ")]),e(T.OQ,[t._v(' Encontramos o aluno "'+t._s(t.foundStudentName)+'". Confirma a adição? ')]),e(T.SL,[e(l.A),e(E.A,{attrs:{outline:"",color:"accent"},on:{click:t.closeStudentDialog}},[t._v("Voltar")]),e(E.A,{attrs:{color:"primary"},on:{click:t.confirmStudent}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.confirmationDialog,callback:function(e){t.confirmationDialog=e},expression:"confirmationDialog"}},[e(C.A,[e(T.ri,[t._v("Confirmação")]),e(T.OQ,[e("p",[t._v(t._s(t.informedStudentsText)+" Portanto você poderá escolher até "),e("b",{staticStyle:{color:"#000084"}},[t._v(t._s(t.maxTables)+" mesas")]),t._v(" (considerando também mesas que já tenha comprado em passos anteriores).")]),e("p",[t._v("Aviso: após confirmar, não será possível voltar.")])]),e(T.SL,[e(l.A),e(E.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.confirmationDialog=!1}}},[t._v("Voltar")]),e(E.A,{attrs:{color:"primary"},on:{click:t.enterQueue}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.clearConfirmationDialog,callback:function(e){t.clearConfirmationDialog=e},expression:"clearConfirmationDialog"}},[e(C.A,[e(T.ri,[t._v("Confirmação")]),e(T.OQ,[t.isStudentStep?e("p",[t._v("Remover alunos selecionados?")]):e("p",[t._v("Limpar campos preenchidos?")])]),e(T.SL,[e(l.A),e(E.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.clearConfirmationDialog=!1}}},[t._v("Voltar")]),e(E.A,{attrs:{color:"primary"},on:{click:t.clear}},[t._v("Sim")])],1)],1)],1)],1)},F=[],B=(i(4114),i(1701),i(1303)),Y={name:"StartForm",components:{FullscreenLoader:b},props:{fromRestart:{type:Boolean,default:!1}},data:function(){return{name:null,identification:null,email:null,uuid:null,loaded:!1,validationEnabled:!1,isStudentStep:!1,students:[],studentCode:null,foundStudentName:null,foundStudentId:null,foundStudentCode:null,dialog:!1,confirmationDialog:!1,clearConfirmationDialog:!1,dataConfirmationDialog:!1,rules:{required:t=>!!t&&t.trim().length>=3||"Digite ao menos 3 caracteres",validEmail:t=>!!t&&/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(t.trim())||"E-mail inválido"}}},mounted:function(){this.load()},computed:{cardTitle:function(){return this.isStudentStep?"Informar Aluno(s)":"Dados para pagamento"},informedStudentsText:function(){return this.students.length?1===this.students.length?"Você informou o RM do aluno "+this.students.map((t=>`"${t.name}"`)).join(", ")+".":"Você informou o RM dos alunos "+this.students.map((t=>`"${t.name}"`)).join(", ")+".":"Identifique ao menos um aluno para continuar."},maxTables:function(){return 2*this.students.length}},methods:{load:async function(){if(this.fromRestart){try{await this.loadLinkedStudents(),this.isStudentStep=!0,this.loaded=!0}catch(e){console.error(e),this.$toasted.error("Erro ao consultar os alunos.")}return}if(this.uuid=localStorage.getItem("uuid_usuario"),this.uuid){let t;try{t=await this.$axios.post("/user/get",{uuid_usuario:this.uuid})}catch(e){return console.error(e),void this.$toasted.error("Não foi possível consultar o servidor")}if(t.data?.user?.id_etapa)return void this.$emit("gotoStep",t.data?.user?.id_etapa);if(t.data?.user)return this.isStudentStep=!0,void(this.loaded=!0)}const t=(0,B.A)();localStorage.setItem("uuid_usuario",t),this.uuid=t,this.loaded=!0},handleAction:function(){this.isStudentStep?this.checkIfCanBuyMoreResources():(this.validationEnabled=!0,this.$nextTick((async()=>{this.$refs.form.validate()&&(this.dataConfirmationDialog=!0)})))},registerUser:async function(){this.loaded=!1;try{const t=await this.$axios.post("/user/create",{uuid_usuario:this.uuid,numero_identificacao:this.identification.trim(),tipo_identificacao:"CPF",email:this.email.trim(),nome:this.name.trim()}),e=t.data.token;localStorage.setItem("token",e),this.$toasted.success("Usuário cadastrado"),this.isStudentStep=!0,this.$refs.form&&this.$refs.form.resetValidation(),this.validationEnabled=!1}catch(t){return void(null!=t.response?.data?.message?this.$toasted.error(t.response.data.message):this.$toasted.error("Ocorreu um erro inesperado!"))}finally{this.loaded=!0}},enterQueue:async function(){this.loaded=!1;try{await this.$axios.post("/user/enter-queue",{codigos_alunos:this.students.map((t=>t.studentCode))})}catch(t){return void(null!=t.response?.data?.message?this.$toasted.error(t.response.data.message):this.$toasted.error("Ocorreu um erro inesperado!"))}finally{this.loaded=!0}this.$emit("next")},back:function(){this.isStudentStep=!1},clear:function(){this.isStudentStep?(this.students=[],this.studentCode=null,this.clearConfirmationDialog=!1):(this.identification=null,this.email=null,this.name=null,this.$refs.form.resetValidation(),this.validationEnabled=!1,this.clearConfirmationDialog=!1)},isValidCPF:function(t){if(null==t)return"CPF inválido";const e=t.replace(/[^\d]+/g,"");if(11!==e.length||/^(\d)\1+$/.test(e))return"CPF inválido";let i=0;for(let a=0;a<9;a++)i+=parseInt(e.charAt(a))*(10-a);let s=10*i%11;if(10!==s&&11!==s||(s=0),s!==parseInt(e.charAt(9)))return"CPF inválido";i=0;for(let a=0;a<10;a++)i+=parseInt(e.charAt(a))*(11-a);return s=10*i%11,10!==s&&11!==s||(s=0),s===parseInt(e.charAt(10))||"CPF inválido"},checkStudent:async function(){this.validationEnabled=!0,this.$nextTick((async()=>{if(!this.$refs.form.validate())return;if(this.students.find((t=>t.studentCode===this.studentCode.trim())))return void this.$toasted.error("Você já adicionou esse aluno");let t;try{t=await this.$axios.post("/student/get",{codigo_aluno:this.studentCode.trim()})}catch(e){return 404===e.status?this.$toasted.error("Aluno não encontrado, por favor revise o código digitado."):400===e.status?this.$toasted.error("O aluno informado já está vinculado a outro usuário."):(console.error(e),this.$toasted.error("Erro inesperado ao consultar aluno"))}this.foundStudentName=t.data.aluno.nome,this.foundStudentId=t.data.aluno.id_aluno,this.foundStudentCode=t.data.aluno.codigo,this.dialog=!0}))},closeStudentDialog:function(){this.dialog=!1,this.$nextTick((()=>{this.foundStudentName=null,this.foundStudentCode=null}))},confirmStudent:function(){this.students.push({name:this.foundStudentName,studentId:this.foundStudentId,studentCode:this.foundStudentCode}),this.$nextTick((()=>{this.foundStudentId=null,this.studentCode=null,this.validationEnabled=!1,this.closeStudentDialog(),this.$toasted.success("Aluno adicionado!")}))},loadLinkedStudents:async function(){const t=await this.$axios.post("/student/linked");t.data?.alunos&&(this.students=t.data.alunos.map((t=>({name:t.nome,studentId:t.id_aluno,studentCode:t.codigo}))))},startClearAction:function(){if(this.fromRestart)return this.$toasted.error("Como você já comprou alguma mesa, não é possível remover os alunos identificados. Caso tenha adicionado um aluno incorretamente, por favor recarregue a página.");this.clearConfirmationDialog=!0},checkIfCanBuyMoreResources:async function(){const t=await this.$axios.post("/resource/booked"),e=t.data?.recursos,i=2*this.students.length;if(null!=e&&e.length>=i)return this.$toasted.error("Você já comprou a quantidade máxima de mesas para o número de alunos identificados. Para comprar mais mesas, é necessário informar o código de mais alunos.");this.confirmationDialog=!0},confirmBasicData:async function(){this.dataConfirmationDialog=!1,await this.registerUser()}}},X=Y,z=(0,y.A)(X,Q,F,!1,null,null,null),G=z.exports,W=i(8143),J=i(6930),K=function(){var t=this,e=t._self._c;return e(m.A,{attrs:{fluid:"","fill-height":""}},[e(C.A,{staticStyle:{width:"100%"}},[e(T.ri,{staticClass:"py-1"},[e(j.A,{attrs:{justify:"center",align:"center"}},[t.step===t.steps.SELECTION&&null!=t.remainingSeconds?e(L.A,[e("countdown-timer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"Tempo para escolher: "}})],1):e(L.A,{staticStyle:{"min-width":"170px",display:"flex","align-content":"center","justify-content":"center"}},[e("span",{staticClass:"mr-2 keep-words"},[t._v(t._s(t.getTitle))]),t.step===t.steps.QUEUE?e(f.A,{attrs:{indeterminate:"",color:"primary"}}):t._e()],1)],1)],1),e(T.OQ,[e("div",{staticClass:"table-map"},[e("div",{staticStyle:{"grid-area":"1 / 14 / span 1 / span 7",display:"grid","place-items":"center"}},[e("h1",[t._v("Cantina e bar")])]),e("div",{staticStyle:{"grid-area":"3 / 21 / span 9 / span 1",display:"grid","place-items":"center"}},[e("h1",{staticStyle:{"writing-mode":"vertical-rl"}},[t._v("Palco da quadra / caixa")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"2 / 1 / 12 / 21",margin:"-10px"}}),t._l(t.positionedResources,(function(i){return e("NumberToggle",{key:i.id_recurso,style:t.getItemStyle(i),attrs:{value:i.id_recurso,number:parseInt(i.nome_recurso_short,10),state:t.getResourceState(i),readonly:t.step===t.steps.QUEUE},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})})),e("div",{staticClass:"palco border"},[e("div",{staticStyle:{"grid-area":"1 / 1 / span 4 / span 7",display:"grid","place-items":"center"}},[e("h1",[t._v("Apresentações")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 1 / span 1 / span 3",display:"grid","place-items":"center"}},[e("h2",[t._v("Fotos")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 5 / span 1 / span 3",display:"grid","place-items":"center"}},[e("h2",[t._v("Fotos")])])]),e("div",{staticStyle:{"grid-area":"12 / 1 / 12 / 7"}},[e("h1",{staticStyle:{"text-align":"left"}},[t._v("Entrada")]),e(J.A,{staticStyle:{transform:"scaleX(4) scaleY(1)","transform-origin":"left"}},[t._v("mdi-arrow-right-bold")])],1),e("div",{staticStyle:{"grid-area":"13 / 1 / 13 / 21",display:"grid","place-items":"center"}},[e("h1",{staticStyle:{"text-align":"left"}},[t._v("Arquibancada")])])],2)])],1),e(q.A,{model:{value:t.informationDialog,callback:function(e){t.informationDialog=e},expression:"informationDialog"}},[e(C.A,[e(T.ri,[t._v(" Seleção de mesas ")]),e(T.OQ,[e("ul",[e("li",[t._v("Para navegar pelo mapa, basta arrastar a tela")]),e("li",[t._v("Quando chegar a sua vez na fila, você poderá clicar nas mesas para escolhê-las")]),e("li",[t._v("Fique atento ao "),e("b",[t._v("tempo limite")]),t._v(" para escolher as mesas. Quando for sua vez, um contador aparecerá no topo da tela.")]),e("li",[t._v('Quando tiver escolhido suas mesas, basta clicar no botão "Comprar mesas" na parte inferior da tela')])])]),e(T.SL,[e(l.A),e(E.A,{attrs:{color:"primary"},on:{click:function(e){t.informationDialog=!1}}},[t._v("OK")])],1)],1)],1),e(W.A,{staticStyle:{"justify-content":"end",gap:"5px"},attrs:{color:"primary",app:""}},[t.step===t.steps.SELECTION?[e("span",{staticStyle:{color:"background"}},[t._v(t._s(t.totalPriceLabel))]),e(l.A),e(E.A,{attrs:{color:"background"},on:{click:function(e){t.informationDialog=!0}}},[t._v("Ajuda")]),e(E.A,{attrs:{color:"background",loading:t.buttonLoading},on:{click:t.requestPickedResources}},[t._v(t._s(t.buyButtonLabel))])]:e(E.A,{attrs:{color:"background"},on:{click:function(e){t.informationDialog=!0}}},[t._v("Ajuda")])],2)],1)},H=[],Z=(i(2489),i(8237),function(){var t=this,e=t._self._c;return e("div",{staticClass:"numbered-checkbox",class:{checked:t.isChecked,"disabled-cursor":1===t.state,"disabled-light":2===t.state,"disabled-dark":3===t.state,"disabled-color":4===t.state},on:{click:t.toggle}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.internalValue,expression:"internalValue"}],staticClass:"hidden-checkbox",attrs:{type:"checkbox",disabled:t.disabled,readonly:t.readonly},domProps:{value:t.value,checked:Array.isArray(t.internalValue)?t._i(t.internalValue,t.value)>-1:t.internalValue},on:{change:[function(e){var i=t.internalValue,s=e.target,a=!!s.checked;if(Array.isArray(i)){var o=t.value,n=t._i(i,o);s.checked?n<0&&(t.internalValue=i.concat([o])):n>-1&&(t.internalValue=i.slice(0,n).concat(i.slice(n+1)))}else t.internalValue=a},t.handleChange]}}),e("span",{staticClass:"checkbox-number"},[t._v(t._s(t.number))])])}),tt=[],et={name:"NumberedCheckbox",model:{prop:"modelValue",event:"change"},props:{value:{type:[String,Number,Boolean,Object],required:!0},modelValue:{type:[Array,Boolean],default:()=>[]},number:{type:Number,required:!0},state:{type:Number,required:!0},readonly:{type:Boolean,default:!1}},computed:{internalValue:{get(){return this.modelValue},set(t){this.$emit("change",t)}},isChecked(){return Array.isArray(this.modelValue)?this.modelValue.includes(this.value):this.modelValue},disabled(){return this.state>0}},methods:{toggle(){if(!this.disabled)if(Array.isArray(this.modelValue)){const t=[...this.modelValue],e=t.indexOf(this.value);-1===e?t.push(this.value):t.splice(e,1),this.$emit("change",t)}else this.$emit("change",!this.modelValue)},handleChange(t){this.$emit("change",t.target.checked)}}},it=et,st=(0,y.A)(it,Z,tt,!1,null,"39b03f1b",null),at=st.exports,ot={name:"ResourceList",components:{NumberToggle:at,CountdownTimer:w},data:function(){return{interval:null,step:1,steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5},resources:[],unavailableResources:[],selected:[],qr_code:null,qr_code_base64:null,buttonLoading:!1,tableLimit:0,remainingSeconds:null,informationDialog:!0,shownAlert:!1,queuePosition:null,pollingInterval:6e4,pollingIntervals:{EVERY_MINUTE:6e4,EVERY_10_SECONDS:1e4,EVERY_5_SECONDS:5e3}}},mounted:function(){this.startPolling()},beforeDestroy:function(){this.stopPollingState()},computed:{getTitle:function(){return this.step===this.steps.QUEUE?this.queuePosition<=2?"Aguarde, você será o próximo a escolher.":null!=this.queuePosition?`Aguarde, você está em ${this.queuePosition}º lugar na fila.`:"Aguarde, você está na fila.":this.step===this.steps.SELECTION?"Tempo para escolher:":null},positionedResources(){return this.resources.filter((t=>null!=t.column_start))},getMySelectedResourceIds(){return this.selected.filter((t=>{const e=this.resources.find((e=>e.id_recurso===t));return 1===e.id_status_recurso||4!==e.id_status_recurso&&1===e.solicitado_por_mim}))},getMyBookedResources(){return this.selected.filter((t=>{const e=this.resources.find((e=>e.id_recurso===t));return 4===e.id_status_recurso&&1===e.solicitado_por_mim}))},buyButtonLabel:function(){return 1===this.getMySelectedResourceIds.length?"Comprar mesa":this.getMySelectedResourceIds.length>1?`Comprar ${this.getMySelectedResourceIds.length} mesas`:"Comprar mesas"},totalPriceLabel:function(){const t=this.getMySelectedResourceIds.reduce(((t,e)=>t+Number(this.resources.find((t=>t.id_recurso===e)).valor)),0);return"Total: R$ "+t.toFixed(2)},resourceLimitReached:function(){return this.getMyBookedResources.length+this.getMySelectedResourceIds.length>=this.tableLimit}},methods:{startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,this.pollingInterval))},stopPollingState:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},changePollingRate:function(t){this.pollingInterval=t,this.interval&&window.clearInterval(this.interval),this.interval=window.setInterval(this.getState,t)},getState:async function(){let t;try{t=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}this.step===this.steps.QUEUE&&t.data.recursos&&(this.resources=t.data.recursos,this.selected=this.resources.filter((t=>1!==t.id_status_recurso)).map((t=>t.id_recurso)));const e=t.data.usuario;return parseInt(e.segundos_restantes_selecao)<0?(this.stopPollingState(),void this.$emit("timeExpired")):(this.step===this.steps.QUEUE&&null!=e.posicao&&(this.queuePosition=parseInt(e.posicao,10),1===this.queuePosition?this.changePollingRate(this.pollingIntervals.EVERY_5_SECONDS):this.queuePosition<=2&&this.changePollingRate(this.pollingIntervals.EVERY_10_SECONDS)),1===e.minha_vez&&this.step===this.steps.QUEUE&&null!=e.limite_mesas?(this.startSelectionStep(),this.tableLimit=parseInt(e.limite_mesas,10),this.remainingSeconds=e.segundos_restantes_selecao,this.$nextTick((()=>{this.$refs.timer.startTimer()})),void this.$toasted.success("Chegou sua vez na fila! Por favor selecione suas mesas.",{position:"top-center"})):void(1===e.minha_vez&&this.step===this.steps.SELECTION&&(this.remainingSeconds=e.segundos_restantes_selecao,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error('Atenção! Você tem menos de um minuto para terminar de selecionar suas mesas. Termine a seleção e clique em "Comprar mesas" dentro do tempo limite para garantir suas mesas.',{position:"top-center",duration:8e3}),this.shownAlert=!0),this.$nextTick((()=>{this.$refs.timer.startTimer()})))))},startSelectionStep:function(){this.step=this.steps.SELECTION,this.changePollingRate(this.pollingIntervals.EVERY_5_SECONDS)},requestPickedResources:async function(){if(!this.getMySelectedResourceIds.length)return void this.$toasted.error("É necessário escolher ao menos uma mesa",{position:"top-center"});let t;this.buttonLoading=!0;try{t=await this.$axios.post("/resource/request",{resource_ids:this.getMySelectedResourceIds})}catch(e){return console.error(e),void this.$toasted.error("Não foi possível solicitar os recursos",{position:"top-center"})}finally{this.buttonLoading=!1}this.stopPollingState(),this.$emit("next",t)},getResourceState:function(t){return 4===t.id_status_recurso&&t.solicitado_por_mim?4:1===t.id_status_recurso||t.solicitado_por_mim?this.step===this.steps.QUEUE?1:this.resourceLimitReached&&-1===this.selected.findIndex((e=>e===t.id_recurso))?2:0:3},getItemStyle:function(t){return null==t.row_start||null==t.row_end||null==t.column_start||null==t.column_end?null:{"grid-row":t.row_start+1+" / span "+(t.row_end-t.row_start+1),"grid-column":t.column_start+" / span "+(t.column_end-t.column_start+1)}}}},nt=ot,rt=(0,y.A)(nt,K,H,!1,null,"3f764b60",null),lt=rt.exports,ct=function(){var t=this,e=t._self._c;return e(m.A,{attrs:{fluid:"","fill-height":""}},[e(C.A,[e(T.ri,[e(j.A,{attrs:{justify:"center",align:"center"}},[null!=t.payment_value?e(L.A,{staticClass:"keep-words"},[t._v(" Pague R$"+t._s(t.payment_value.toFixed(2))+" via PIX ")]):t._e(),null!=t.remainingSeconds?e(L.A,[e("countdown-timer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"Tempo restante"}})],1):t._e()],1)],1),e(T.OQ,[e("div",{staticClass:"mb-2"},[t._v("Escaneie o código QR:")]),t.qr_code_base64?e(n.A,{attrs:{src:`data:image/png;base64,${t.qr_code_base64}`}}):t._e(),e(V.A,{staticClass:"mb-1"}),e("div",{staticClass:"mb-2"},[t._v("Ou use o código abaixo:")]),e(U.A,{attrs:{id:"textToCopy",readonly:"",value:t.qr_code,"append-icon":"mdi-content-copy"},on:{"click:append":t.copyCode}}),e(j.A,{attrs:{align:"center",justify:"center"}},[e(L.A,{staticStyle:{display:"grid","place-items":"center"},attrs:{cols:"12"}},[e(E.A,{attrs:{color:"primary"},on:{click:t.copyCode}},[t._v("Copiar código")])],1)],1),e(j.A,[e(L.A,[e("p",[t._v("Você será redirecionado automaticamente assim que o pagamento for aprovado.")])])],1)],1)],1)],1)},ut=[],dt={name:"PaymentStep",components:{CountdownTimer:w},data:function(){return{qr_code:null,qr_code_base64:null,payment_value:null,interval:null,remainingSeconds:null,shownAlert:!1}},mounted:function(){this.loadPayment(),this.startPolling()},beforeDestroy:function(){this.stopPolling()},methods:{loadPayment:async function(){const t=await this.$axios.post("/payment");if(t.data.pagamento){const{qr_code:e,qr_code_base64:i,valor:s}=t.data.pagamento;this.qr_code=e,this.qr_code_base64=i,this.payment_value=Number(s)}},startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,5e3))},stopPolling:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},getState:async function(){let t;try{t=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}const e=t.data.usuario;return 4===e.id_etapa?(this.stopPolling(),void this.$emit("next")):parseInt(e.segundos_restantes_pagamento,10)<0?(this.stopPolling(),void this.$emit("timeExpired")):(this.remainingSeconds=e.segundos_restantes_pagamento,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error("Atenção! Você tem menos de um minuto para realizar o pagamento. Realize o pagamento dentro do tempo limite para garantir suas mesas.",{duration:8e3}),this.shownAlert=!0),void this.$nextTick((()=>{this.$refs.timer.startTimer()})))},copyCode:async function(){try{let t=document.querySelector("#textToCopy");t.select(),document.execCommand("copy"),this.$toasted.success("Código copiado!")}catch(t){console.error(t),this.$toasted.error("Não foi possível copiar o código")}}}},mt=dt,ht=(0,y.A)(mt,ct,ut,!1,null,"030f156e",null),pt=ht.exports,ft=function(){var t=this,e=t._self._c;return e(m.A,{attrs:{fluid:"","fill-height":""}},[t.bookedResources.length?t._e():e("FullscreenLoader"),e(C.A,{staticStyle:{width:"100%"}},[e(T.ri,[t._v(" Compra finalizada ")]),e(T.OQ,[e("p",[t._v(t._s(t.getBookedResourcesText))])]),e(T.SL,[e(l.A),e(E.A,{attrs:{color:"primary"},on:{click:t.buyMore}},[t._v("Comprar mais mesas")])],1)],1)],1)},gt=[],vt={name:"PurchaseFinished",components:{FullscreenLoader:b},data:function(){return{bookedResources:[],headers:[{text:"Nome",value:"nome_recurso"}]}},computed:{getBookedResourcesText:function(){return this.bookedResources.length>1?"Mesas reservadas para você: "+this.bookedResources.map((t=>t.nome_recurso_short)).join(", "):"Mesa reservada para você: "+this.bookedResources.map((t=>t.nome_recurso_short)).join(", ")}},mounted:function(){this.loadBookedResources()},methods:{loadBookedResources:async function(){const t=await this.$axios.post("/resource/booked");t.data.recursos&&t.data.recursos.length?this.bookedResources=t.data.recursos:window.setTimeout(this.loadBookedResources,1e3)},buyMore:function(){this.$emit("restart")}}},_t=vt,St=(0,y.A)(_t,ft,gt,!1,null,null,null),yt=St.exports,At=function(){var t=this,e=t._self._c;return e(m.A,{attrs:{fluid:"","fill-height":""}},[e(C.A,{staticStyle:{width:"100%"}},[e(T.ri,[t._v(" Tempo expirado! ")]),e(T.OQ,[e("p",[t._v(t._s(t.getMessage))])]),e(T.SL,[e(l.A),e(E.A,{attrs:{color:"primary"},on:{click:t.buyMore}},[t._v("Voltar para comprar mesas")])],1)],1)],1)},bt=[],Et={name:"TimeExpired",data:function(){return{steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6}}},props:{step:{type:Number,required:!0}},computed:{getMessage:function(){return this.step===this.steps.SELECTION_EXPIRED?"O tempo para escolher as mesas expirou. Você pode clicar no botão abaixo para voltar para a fila novamente.":this.step===this.steps.PAYMENT_EXPIRED?"O tempo para pagamento expirou. Você pode clicar no botão abaixo para voltar para a fila novamente.":null}},methods:{buyMore:function(){this.$emit("restart")}}},Ct=Et,Tt=(0,y.A)(Ct,At,bt,!1,null,null,null),kt=Tt.exports,xt={name:"App",components:{StartWaiting:O,StartForm:G,ResourceList:lt,PaymentStep:pt,PurchaseFinished:yt,TimeExpired:kt},data:()=>({steps:{START_WAITING:-1,REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6},step:-1,restart:!1}),methods:{handleGotoStep:function(t){this.step=this.steps[Object.keys(this.steps).find((e=>this.steps[e]===t))]},handleRestart:function(){this.step=this.steps.REGISTER,this.restart=!0}}},It=xt,Rt=(0,y.A)(It,u,d,!1,null,null,null),Pt=Rt.exports,wt=i(5868);s.Ay.use(wt.A);var $t=new wt.A({theme:{themes:{light:{primary:"#000084",secondary:"#e6e998",accent:"#d82621",error:"#d82621",background:"#fafafa"}}}}),Dt=i(5160),Nt=i.n(Dt),Ot=i(4335);const Lt=Ot.A.create({baseURL:"http://localhost:8080",timeout:1e4,headers:{"Content-Type":"application/json"}});fetch("https://gist.githubusercontent.com/allanwk/87bd602da06208026c25dfe3309fabe9/raw/url.json?t="+Date.now()).then((t=>t.json())).then((t=>{Lt.defaults.baseURL=t.prod})),Lt.interceptors.request.use((t=>(t.headers["X-User-Uuid"]=localStorage.getItem("uuid_usuario"),t.headers["Authorization"]=localStorage.getItem("token"),t)));var qt=Lt,Vt=i(9928),Mt=i.n(Vt);s.Ay.config.productionTip=!1,s.Ay.prototype.$axios=qt,s.Ay.use(Nt(),{position:"bottom-center",duration:3e3,theme:"toasted-primary"}),s.Ay.use(Mt()),new s.Ay({vuetify:$t,render:t=>t(Pt)}).$mount("#app")}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,i),o.exports}i.m=t,function(){var t=[];i.O=function(e,s,a,o){if(!s){var n=1/0;for(u=0;u<t.length;u++){s=t[u][0],a=t[u][1],o=t[u][2];for(var r=!0,l=0;l<s.length;l++)(!1&o||n>=o)&&Object.keys(i.O).every((function(t){return i.O[t](s[l])}))?s.splice(l--,1):(r=!1,o<n&&(n=o));if(r){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[s,a,o]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,o,n=s[0],r=s[1],l=s[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var u=l(i)}for(e&&e(s);c<n.length;c++)o=n[c],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(u)},s=self["webpackChunklemefest"]=self["webpackChunklemefest"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[504],(function(){return i(7615)}));s=i.O(s)})();
//# sourceMappingURL=app.938f0e11.js.map