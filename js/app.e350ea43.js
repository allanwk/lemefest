(function(){"use strict";var t={4496:function(t,e,i){t.exports=i.p+"img/colegio.5e9df97c.png"},6797:function(t,e,i){var a=i(5471),s=i(5668),o=i(301),n=i(5420),r=i(5322),l=i(1034),c=i(2367),d=function(){var t=this,e=t._self._c;return e(s.A,[e(o.A,{attrs:{app:"",color:"primary",dark:""}},[e(c.sw,[t._v("Festa Junina Leme 2025")]),e(l.A),e(n.A,{attrs:{src:i(4496),contain:"",height:"40","max-width":"40"}})],1),e(r.A,{staticClass:"background"},[t.step===t.steps.START_WAITING?e("StartWaiting",{on:{next:function(e){t.step=t.steps.REGISTER}}}):t._e(),t.step===t.steps.REGISTER?e("StartForm",{attrs:{fromRestart:t.restart},on:{gotoStep:t.handleGotoStep,next:function(e){t.step=t.steps.QUEUE}}}):t._e(),[t.steps.QUEUE,t.steps.SELECTION].includes(t.step)?e("ResourceList",{on:{next:function(e){t.step=t.steps.PAYMENT},timeExpired:function(e){t.step=t.steps.SELECTION_EXPIRED}}}):t._e(),t.step===t.steps.PAYMENT?e("PaymentStep",{on:{next:function(e){t.step=t.steps.PAID},timeExpired:function(e){t.step=t.steps.PAYMENT_EXPIRED}}}):t._e(),t.step===t.steps.PAID?e("PurchaseFinished",{on:{restart:t.handleRestart}}):t._e(),[t.steps.PAYMENT_EXPIRED,t.steps.SELECTION_EXPIRED].includes(t.step)?e("TimeExpired",{attrs:{step:t.step},on:{restart:t.handleRestart}}):t._e()],1)],1)},u=[],m=(i(8111),i(116),i(1484)),h=i(2938),p=i(3449),f=function(){var t=this,e=t._self._c;return e(p.A,{staticClass:"d-flex justify-center",attrs:{fluid:"","fill-height":""}},[t.loaded?null!=t.remainingSeconds?e("CountdownTimer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"O cadastro para seleção das mesas começará em:"},on:{timerEnd:t.waitThenCheckIfStarted}}):t._e():e("FullscreenLoader"),t.unavailable?e(m.A,{attrs:{"max-width":"500"}},[e(h.ri,{staticClass:"keep-words"},[t._v("Parece que o sistema ainda não está disponível, tente novamente mais tarde.")])],1):t._e()],1)},g=[],v=i(1554),_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"fullscreen-loader"},[e(v.A,{attrs:{indeterminate:"",size:"64",color:"primary"}})],1)},S=[],y={},A=y,b=i(1656),E=(0,b.A)(A,_,S,!1,null,"160064d0",null),T=E.exports,C=i(5835),x=function(){var t=this,e=t._self._c;return e(m.A,{staticClass:"countdown-timer py-0",attrs:{outlined:""}},[e(h.OQ,{staticClass:"text-center py-0"},[t._v(" "+t._s(t.message)+" "),e("div",{staticClass:"time-display text-h5 font-weight-bold"},[t._v(" "+t._s(t.formattedMinutes)+":"+t._s(t.formattedSeconds)+" ")]),t.showControls?e(h.SL,{staticClass:"justify-center"},[e(C.A,{attrs:{color:"primary",disabled:t.remainingTime<=0},on:{click:t.toggleTimer}},[t._v(" "+t._s(t.isRunning?"Pause":"Start")+" ")]),e(C.A,{attrs:{color:"secondary",disabled:t.remainingTime===t.initialTime},on:{click:t.resetTimer}},[t._v(" Reset ")])],1):t._e()],1)],1)},k=[],w={name:"CountdownTimer",props:{initialTime:{type:Number,required:!0,validator:t=>t>=0},showControls:{type:Boolean,default:!1},autoStart:{type:Boolean,default:!1},message:{type:String}},data(){return{remainingTime:this.initialTime,timer:null,isRunning:!1}},computed:{formattedMinutes(){const t=Math.floor(this.remainingTime/60);return t.toString().padStart(2,"0")},formattedSeconds(){const t=this.remainingTime%60;return t.toString().padStart(2,"0")},timeWarning(){return this.remainingTime<=10},timeCritical(){return this.remainingTime<=5}},watch:{initialTime(t){this.resetTimer(t)}},mounted(){this.autoStart&&this.startTimer()},beforeDestroy(){this.clearTimer()},methods:{startTimer(){this.clearTimer(),this.remainingTime>0&&(this.isRunning=!0,this.timer=setInterval((()=>{this.remainingTime-=1,this.remainingTime<=0&&(this.remainingTime=0,this.clearTimer(),this.$emit("timerEnd"))}),1e3))},pauseTimer(){this.clearTimer(),this.isRunning=!1},toggleTimer(){this.isRunning?this.pauseTimer():this.startTimer()},resetTimer(t=this.initialTime){this.pauseTimer(),this.remainingTime=t,this.$emit("timer-reset")},clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},addTime(t){this.remainingTime+=t,!this.isRunning&&this.remainingTime>0&&this.startTimer()},setTime(t){this.resetTimer(t)}}},I=w,P=(0,b.A)(I,x,k,!1,null,"64c6abf5",null),R=P.exports,$={name:"StartWaiting",components:{FullscreenLoader:T,CountdownTimer:R},data:function(){return{loaded:!1,remainingSeconds:null,interval:null,retried:!1,unavailable:!1,timerEnded:!1}},mounted:async function(){await this.checkIfStarted()},methods:{checkIfStarted:async function(){try{const t=await this.$axios.post("/state/getStarted");null!=t.data.segundos_ate_liberacao&&(parseInt(t.data.segundos_ate_liberacao,10)<=0?this.$emit("next"):(this.loaded=!0,this.remainingSeconds=t.data.segundos_ate_liberacao,this.$nextTick((()=>{this.$refs.timer.startTimer()}))))}catch(t){console.log(t),!this.retried||this.timerEnded?(this.retried=!0,window.setTimeout(this.checkIfStarted,5e3)):(this.loaded=!0,this.unavailable=!0)}},waitThenCheckIfStarted:async function(){this.loaded=!1,this.timerEnded=!0;const t=Math.floor(501*Math.random());window.setTimeout(this.checkIfStarted,t)}}},D=$,N=(0,b.A)(D,f,g,!1,null,"eea9546c",null),L=N.exports,O=i(4414),q=i(2413),M=i(9483),V=i(174),j=i(2756),F=i(2494),U=function(){var t=this,e=t._self._c;return e(p.A,{staticClass:"d-flex align-center justify-center",staticStyle:{"justify-content":"space-around"},attrs:{"fill-height":"",fluid:""}},[t.loaded?t._e():e("FullscreenLoader"),e("div",{staticClass:"d-flex align-center justify-center",staticStyle:{width:"100%"}},[e(m.A,{staticClass:"mt-n10",staticStyle:{width:"100%"},attrs:{"max-width":"500"}},[e(h.ri,[t._v(" "+t._s(t.cardTitle)+" ")]),e(h.OQ,[e(V.A,{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t.isStudentStep?[e("p",[t._v("Para cada aluno identificado, você poderá comprar até 2 mesas")]),e(j.A,{attrs:{align:"center",justify:"center"}},[e(O.A,[e(F.A,{directives:[{name:"mask",rawName:"v-mask",value:"###########",expression:"'###########'"}],attrs:{label:"RM do aluno",required:"",rules:t.validationEnabled?[t.rules.required]:[],clearable:"",inputmode:"numeric",pattern:"[0-9]*"},model:{value:t.studentCode,callback:function(e){t.studentCode=e},expression:"studentCode"}})],1),e(O.A,{attrs:{cols:"5"}},[e(C.A,{attrs:{color:"primary",outlined:"",loading:t.loadingAddStudent},on:{click:t.checkStudent}},[t._v("Adicionar")])],1)],1),e(M.A),e("p",{staticClass:"mt-4"},[t._v(t._s(t.informedStudentsText))])]:[e("p",[t._v("Por favor preencha corretamente. Precisamos desses dados para processar o pagamento via PIX.")]),e(F.A,{attrs:{label:"Nome Completo",required:"",rules:t.validationEnabled?[t.rules.required]:[],clearable:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),e(F.A,{directives:[{name:"mask",rawName:"v-mask",value:"###.###.###-##",expression:"'###.###.###-##'"}],attrs:{label:"CPF",required:"",rules:t.validationEnabled?[t.rules.required,t.isValidCPF]:[],clearable:"",inputmode:"numeric",pattern:"[0-9]*"},model:{value:t.identification,callback:function(e){t.identification=e},expression:"identification"}}),e(F.A,{staticStyle:{"text-transform":"none"},attrs:{label:"Email",type:"email",required:"",rules:t.validationEnabled?[t.rules.required,t.rules.validEmail]:[],clearable:"",autocapitalize:"off"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handleSubmit.apply(null,arguments))}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})]],2)],1),e(h.SL,[e(l.A),e(C.A,{attrs:{color:"accent"},on:{click:t.startClearAction}},[t._v("Limpar")]),t.isStudentStep?e(C.A,{attrs:{disabled:t.isStudentStep&&!t.students.length,loading:t.handleNextLoading,color:"primary"},on:{click:t.handleAction}},[t._v("Próximo")]):e(C.A,{attrs:{color:"primary"},on:{click:t.handleAction}},[t._v("Salvar")])],1)],1)],1),e(q.A,{model:{value:t.dataConfirmationDialog,callback:function(e){t.dataConfirmationDialog=e},expression:"dataConfirmationDialog"}},[e(m.A,[e(h.ri,[t._v("Os dados estão corretos?")]),e(h.OQ,[e("p",[t._v("Nome: "+t._s(t.name))]),e("p",[t._v("CPF: "+t._s(t.identification))]),e("p",[t._v("E-mail: "+t._s(t.email))]),e("b",[t._v("Verifique com cuidado, você não poderá alterá-los depois!")])]),e(h.SL,[e(l.A),e(C.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.dataConfirmationDialog=!1}}},[t._v("Voltar")]),e(C.A,{attrs:{color:"primary"},on:{click:t.confirmBasicData}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(m.A,[e(h.ri,[t._v(" Aluno encontrado ")]),e(h.OQ,[t._v(' Encontramos o aluno "'+t._s(t.foundStudentName)+'". Confirma a adição? ')]),e(h.SL,[e(l.A),e(C.A,{attrs:{outline:"",color:"accent"},on:{click:t.closeStudentDialog}},[t._v("Voltar")]),e(C.A,{attrs:{color:"primary"},on:{click:t.confirmStudent}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.confirmationDialog,callback:function(e){t.confirmationDialog=e},expression:"confirmationDialog"}},[e(m.A,[e(h.ri,[t._v("Confirmação")]),e(h.OQ,[e("p",[t._v(t._s(t.informedStudentsText)+" Portanto você poderá escolher até "),e("b",{staticStyle:{color:"#000084"}},[t._v(t._s(t.maxTables)+" mesas")]),t._v(" (considerando também mesas que já tenha comprado em passos anteriores).")]),e("p",[t._v("Aviso: após confirmar, não será possível voltar.")])]),e(h.SL,[e(l.A),e(C.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.confirmationDialog=!1}}},[t._v("Voltar")]),e(C.A,{attrs:{color:"primary"},on:{click:t.enterQueue}},[t._v("Confirmar")])],1)],1)],1),e(q.A,{model:{value:t.clearConfirmationDialog,callback:function(e){t.clearConfirmationDialog=e},expression:"clearConfirmationDialog"}},[e(m.A,[e(h.ri,[t._v("Confirmação")]),e(h.OQ,[t.isStudentStep?e("p",[t._v("Remover alunos selecionados?")]):e("p",[t._v("Limpar campos preenchidos?")])]),e(h.SL,[e(l.A),e(C.A,{attrs:{outline:"",color:"accent"},on:{click:function(e){t.clearConfirmationDialog=!1}}},[t._v("Voltar")]),e(C.A,{attrs:{color:"primary"},on:{click:t.clear}},[t._v("Sim")])],1)],1)],1),e(q.A,{model:{value:t.errorDialog,callback:function(e){t.errorDialog=e},expression:"errorDialog"}},[e(m.A,[e(h.ri,{staticClass:"keep-words"},[t._v(t._s(t.errorDialogMessage))]),e(h.SL,[e(l.A),e(C.A,{attrs:{outline:"",color:"primary"},on:{click:function(e){t.errorDialog=!1}}},[t._v("OK")])],1)],1)],1)],1)},Q=[],B=(i(4114),i(1701),i(1303)),Y={name:"StartForm",components:{FullscreenLoader:T},props:{fromRestart:{type:Boolean,default:!1}},data:function(){return{name:null,identification:null,email:null,uuid:null,loaded:!1,validationEnabled:!1,isStudentStep:!1,students:[],studentCode:null,foundStudentName:null,foundStudentId:null,foundStudentCode:null,dialog:!1,confirmationDialog:!1,clearConfirmationDialog:!1,dataConfirmationDialog:!1,loadingAddStudent:!1,handleNextLoading:!1,errorDialog:!1,errorDialogMessage:null,rules:{required:t=>!!t&&t.trim().length>=3||"Digite ao menos 3 caracteres",validEmail:t=>!!t&&/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(t.trim())||"E-mail inválido"}}},mounted:function(){this.load()},computed:{cardTitle:function(){return this.isStudentStep?"Informar Aluno(s)":"Dados para pagamento"},informedStudentsText:function(){return this.students.length?1===this.students.length?"Você informou o RM do aluno "+this.students.map((t=>`"${t.name}"`)).join(", ")+".":"Você informou o RM dos alunos "+this.students.map((t=>`"${t.name}"`)).join(", ")+".":"Identifique ao menos um aluno para continuar."},maxTables:function(){return 2*this.students.length}},methods:{load:async function(){if(this.fromRestart){try{await this.loadLinkedStudents(),this.isStudentStep=!0,this.loaded=!0}catch(e){console.error(e),this.$toasted.error("Erro ao consultar os alunos.")}return}if(this.uuid=localStorage.getItem("uuid_usuario"),this.uuid){let t;try{t=await this.$axios.post("/user/get",{uuid_usuario:this.uuid})}catch(e){return console.error(e),void this.$toasted.error("Não foi possível consultar o servidor")}if(t.data?.user?.id_etapa)return void this.$emit("gotoStep",t.data?.user?.id_etapa);if(t.data?.user)return this.isStudentStep=!0,void(this.loaded=!0)}const t=(0,B.A)();localStorage.setItem("uuid_usuario",t),this.uuid=t,this.loaded=!0},handleSubmit:function(){console.log("handleSubmit"),this.isStudentStep?(this.validationEnabled=!0,this.$nextTick((async()=>{this.$refs.form.validate()&&this.checkStudent()}))):this.handleAction()},handleAction:function(){this.isStudentStep?this.checkIfCanBuyMoreResources():(this.validationEnabled=!0,this.$nextTick((async()=>{this.$refs.form.validate()&&(this.dataConfirmationDialog=!0)})))},registerUser:async function(){this.loaded=!1;try{const t=await this.$axios.post("/user/create",{uuid_usuario:this.uuid,numero_identificacao:this.identification.trim(),tipo_identificacao:"CPF",email:this.email.trim(),nome:this.name.trim()}),e=t.data.token;localStorage.setItem("token",e),this.$toasted.success("Usuário cadastrado"),this.isStudentStep=!0,this.$refs.form&&this.$refs.form.resetValidation(),this.validationEnabled=!1}catch(t){return void(null!=t.response?.data?.message?this.$toasted.error(t.response.data.message):this.$toasted.error("Ocorreu um erro inesperado!"))}finally{this.loaded=!0}},enterQueue:async function(){this.loaded=!1;try{await this.$axios.post("/user/enter-queue",{codigos_alunos:this.students.map((t=>t.studentCode))})}catch(t){return void(null!=t.response?.data?.message?this.$toasted.error(t.response.data.message):this.$toasted.error("Ocorreu um erro inesperado!"))}finally{this.loaded=!0}this.$emit("next")},back:function(){this.isStudentStep=!1},clear:function(){this.isStudentStep?(this.students=[],this.studentCode=null,this.clearConfirmationDialog=!1):(this.identification=null,this.email=null,this.name=null,this.$refs.form.resetValidation(),this.validationEnabled=!1,this.clearConfirmationDialog=!1)},isValidCPF:function(t){if(null==t)return"CPF inválido";const e=t.replace(/[^\d]+/g,"");if(11!==e.length||/^(\d)\1+$/.test(e))return"CPF inválido";let i=0;for(let s=0;s<9;s++)i+=parseInt(e.charAt(s))*(10-s);let a=10*i%11;if(10!==a&&11!==a||(a=0),a!==parseInt(e.charAt(9)))return"CPF inválido";i=0;for(let s=0;s<10;s++)i+=parseInt(e.charAt(s))*(11-s);return a=10*i%11,10!==a&&11!==a||(a=0),a===parseInt(e.charAt(10))||"CPF inválido"},checkStudent:async function(){this.validationEnabled=!0,this.$nextTick((async()=>{if(!this.$refs.form.validate())return;if(this.students.find((t=>t.studentCode===this.studentCode.trim())))return void this.showError("Você já adicionou esse aluno.");let t;this.loadingAddStudent=!0;try{t=await this.$axios.post("/student/get",{codigo_aluno:this.studentCode.trim()})}catch(e){return 404===e.status?this.showError("Aluno não encontrado, por favor revise o código digitado."):400===e.status?this.showError("O aluno informado já está vinculado a outro usuário."):this.showError("Erro inesperado ao consultar aluno.")}finally{this.loadingAddStudent=!1}this.foundStudentName=t.data.aluno.nome,this.foundStudentId=t.data.aluno.id_aluno,this.foundStudentCode=t.data.aluno.codigo,this.dialog=!0}))},closeStudentDialog:function(){this.dialog=!1,this.$nextTick((()=>{this.foundStudentName=null,this.foundStudentCode=null}))},confirmStudent:function(){this.students.push({name:this.foundStudentName,studentId:this.foundStudentId,studentCode:this.foundStudentCode}),this.$nextTick((()=>{this.foundStudentId=null,this.studentCode=null,this.validationEnabled=!1,this.closeStudentDialog(),this.$toasted.success("Aluno adicionado!")}))},loadLinkedStudents:async function(){const t=await this.$axios.post("/student/linked");t.data?.alunos&&(this.students=t.data.alunos.map((t=>({name:t.nome,studentId:t.id_aluno,studentCode:t.codigo}))))},startClearAction:function(){if(this.fromRestart)return this.$toasted.error("Como você já comprou alguma mesa, não é possível remover os alunos identificados. Caso tenha adicionado um aluno incorretamente, por favor recarregue a página.");this.clearConfirmationDialog=!0},checkIfCanBuyMoreResources:async function(){this.handleNextLoading=!0;try{const t=await this.$axios.post("/resource/booked"),e=t.data?.recursos,i=2*this.students.length;if(null!=e&&e.length>=i)return this.$toasted.error("Você já comprou a quantidade máxima de mesas para o número de alunos identificados. Para comprar mais mesas, é necessário informar o código de mais alunos.");this.confirmationDialog=!0}catch(t){this.$toasted.error("Erro inesperado!")}finally{this.handleNextLoading=!1}},confirmBasicData:async function(){this.dataConfirmationDialog=!1,await this.registerUser()},showError:function(t){this.errorDialogMessage=t,this.$nextTick((()=>{this.errorDialog=!0}))}}},X=Y,z=(0,b.A)(X,U,Q,!1,null,null,null),G=z.exports,W=i(8143),K=i(6930),J=function(){var t=this,e=t._self._c;return e(p.A,{attrs:{fluid:"","fill-height":""}},[t.loaded?[e(m.A,{staticStyle:{width:"100%"}},[e(h.ri,{staticClass:"py-1"},[e(j.A,{attrs:{justify:"center",align:"center"}},[t.step===t.steps.SELECTION&&null!=t.remainingSeconds?e(O.A,[e("countdown-timer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"Tempo para escolher: "},on:{timerEnd:t.atTimerEnd}})],1):e(O.A,{staticStyle:{"min-width":"170px",display:"flex","align-content":"center","justify-content":"center"}},[e("span",{staticClass:"mr-2 keep-words"},[t._v(t._s(t.getTitle))]),t.step===t.steps.QUEUE?e(v.A,{attrs:{indeterminate:"",color:"primary"}}):t._e()],1)],1)],1),e(h.OQ,[e("div",{staticClass:"table-map"},[e("div",{staticStyle:{"grid-area":"1 / 14 / span 1 / span 7",display:"grid","place-items":"center"}},[e("h1",[t._v("Cantina e bar")])]),e("div",{staticStyle:{"grid-area":"3 / 21 / span 9 / span 1",display:"grid","place-items":"center"}},[e("h1",{staticStyle:{"writing-mode":"vertical-rl"}},[t._v("Palco da quadra / caixa")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"2 / 1 / 12 / 21",margin:"-10px"}}),t._l(t.resources,(function(i){return e("NumberToggle",{key:i.id_recurso,style:t.getItemStyle(i),attrs:{value:i.id_recurso,number:parseInt(i.nome_recurso_short,10),state:t.getResourceState(i),readonly:t.step===t.steps.QUEUE},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})})),e("div",{staticClass:"palco border"},[e("div",{staticStyle:{"grid-area":"1 / 1 / span 4 / span 7",display:"grid","place-items":"center"}},[e("h1",[t._v("Apresentações")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 1 / span 1 / span 3",display:"grid","place-items":"center"}},[e("h2",[t._v("Fotos")])]),e("div",{staticClass:"border",staticStyle:{"grid-area":"5 / 5 / span 1 / span 3",display:"grid","place-items":"center"}},[e("h2",[t._v("Fotos")])])]),e("div",{staticStyle:{"grid-area":"12 / 1 / 12 / 7"}},[e("h1",{staticStyle:{"text-align":"left"}},[t._v("Entrada")]),e(K.A,{staticStyle:{transform:"scaleX(4) scaleY(1)","transform-origin":"left"}},[t._v("mdi-arrow-right-bold")])],1),e("div",{staticStyle:{"grid-area":"13 / 1 / 13 / 21",display:"grid","place-items":"center"}},[e("h1",{staticStyle:{"text-align":"left"}},[t._v("Arquibancada")])])],2)])],1),e(q.A,{model:{value:t.informationDialog,callback:function(e){t.informationDialog=e},expression:"informationDialog"}},[e(m.A,[e(h.ri,[t._v(" Seleção de mesas ")]),e(h.OQ,[e("ul",[e("li",[t._v("Para navegar pelo mapa, basta arrastar a tela")]),e("li",[t._v("Quando chegar a sua vez na fila, você poderá clicar nas mesas para escolhê-las")]),e("li",[t._v("Fique atento ao "),e("b",[t._v("tempo limite")]),t._v(" para escolher as mesas. Quando for sua vez, um contador aparecerá no topo da tela.")]),e("li",[t._v('Quando tiver escolhido suas mesas, basta clicar no botão "Comprar mesas" na parte inferior da tela')])])]),e(h.SL,[e(l.A),e(C.A,{attrs:{color:"primary"},on:{click:function(e){t.informationDialog=!1}}},[t._v("OK")])],1)],1)],1),e(W.A,{staticStyle:{"justify-content":"end",gap:"5px"},attrs:{color:"primary",app:""}},[t.step===t.steps.SELECTION?[e("span",{staticStyle:{color:"background"}},[t._v(t._s(t.totalPriceLabel))]),e(l.A),e(C.A,{attrs:{color:"background"},on:{click:function(e){t.informationDialog=!0}}},[t._v("Ajuda")]),e(C.A,{attrs:{color:"background",loading:t.buttonLoading},on:{click:t.requestPickedResources}},[t._v(t._s(t.buyButtonLabel))])]:e(C.A,{attrs:{color:"background"},on:{click:function(e){t.informationDialog=!0}}},[t._v("Ajuda")])],2)]:e("FullscreenLoader")],2)},H=[],Z=(i(2489),i(8237),function(){var t=this,e=t._self._c;return e("div",{staticClass:"numbered-checkbox",class:{checked:t.isChecked,"disabled-cursor":1===t.state,"disabled-light":2===t.state,"disabled-dark":3===t.state,"disabled-color":4===t.state},on:{click:t.toggle}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.internalValue,expression:"internalValue"}],staticClass:"hidden-checkbox",attrs:{type:"checkbox",disabled:t.disabled,readonly:t.readonly},domProps:{value:t.value,checked:Array.isArray(t.internalValue)?t._i(t.internalValue,t.value)>-1:t.internalValue},on:{change:[function(e){var i=t.internalValue,a=e.target,s=!!a.checked;if(Array.isArray(i)){var o=t.value,n=t._i(i,o);a.checked?n<0&&(t.internalValue=i.concat([o])):n>-1&&(t.internalValue=i.slice(0,n).concat(i.slice(n+1)))}else t.internalValue=s},t.handleChange]}}),e("span",{staticClass:"checkbox-number"},[t._v(t._s(t.number))])])}),tt=[],et={name:"NumberedCheckbox",model:{prop:"modelValue",event:"change"},props:{value:{type:[String,Number,Boolean,Object],required:!0},modelValue:{type:[Array,Boolean],default:()=>[]},number:{type:Number,required:!0},state:{type:Number,required:!0},readonly:{type:Boolean,default:!1}},computed:{internalValue:{get(){return this.modelValue},set(t){this.$emit("change",t)}},isChecked(){return Array.isArray(this.modelValue)?this.modelValue.includes(this.value):this.modelValue},disabled(){return this.state>0}},methods:{toggle(){if(!this.disabled)if(Array.isArray(this.modelValue)){const t=[...this.modelValue],e=t.indexOf(this.value);-1===e?t.push(this.value):t.splice(e,1),this.$emit("change",t)}else this.$emit("change",!this.modelValue)},handleChange(t){this.$emit("change",t.target.checked)}}},it=et,at=(0,b.A)(it,Z,tt,!1,null,"39b03f1b",null),st=at.exports,ot={name:"ResourceList",components:{NumberToggle:st,CountdownTimer:R,FullscreenLoader:T},data:function(){return{loaded:!1,interval:null,step:1,steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5},resources:[],unavailableResources:[],selected:[],qr_code:null,qr_code_base64:null,buttonLoading:!1,tableLimit:0,remainingSeconds:null,informationDialog:!0,shownAlert:!1,queuePosition:null,pollingInterval:6e4,pollingIntervals:{EVERY_MINUTE:6e4,EVERY_10_SECONDS:1e4,EVERY_5_SECONDS:5e3},timeout:null}},mounted:function(){this.startPolling()},beforeDestroy:function(){this.stopPollingState(),this.timeout&&window.clearTimeout(this.timeout)},computed:{getTitle:function(){return this.step===this.steps.QUEUE?this.queuePosition<=2?"Aguarde, você será o próximo a escolher.":null!=this.queuePosition?`Aguarde, você está em ${this.queuePosition}º lugar na fila.`:"Aguarde, você está na fila.":this.step===this.steps.SELECTION?"Tempo para escolher:":null},getMySelectedResourceIds(){return this.selected.filter((t=>{const e=this.resources.find((e=>e.id_recurso===t));return 1===e.id_status_recurso||4!==e.id_status_recurso&&1===e.solicitado_por_mim}))},getMyBookedResources(){return this.selected.filter((t=>{const e=this.resources.find((e=>e.id_recurso===t));return 4===e.id_status_recurso&&1===e.solicitado_por_mim}))},buyButtonLabel:function(){return 1===this.getMySelectedResourceIds.length?"Comprar mesa":this.getMySelectedResourceIds.length>1?`Comprar ${this.getMySelectedResourceIds.length} mesas`:"Comprar mesas"},totalPriceLabel:function(){const t=this.getMySelectedResourceIds.reduce(((t,e)=>t+Number(this.resources.find((t=>t.id_recurso===e)).valor)),0);return"Total: R$ "+t.toFixed(2)},resourceLimitReached:function(){return this.getMyBookedResources.length+this.getMySelectedResourceIds.length>=this.tableLimit}},methods:{startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,this.pollingInterval))},stopPollingState:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},changePollingRate:function(t){this.pollingInterval=t,this.interval&&window.clearInterval(this.interval),this.interval=window.setInterval(this.getState,t)},getState:async function(){let t;try{t=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}this.step!==this.steps.QUEUE&&this.resources.length||!t.data.recursos||(this.resources=t.data.recursos,this.selected=this.resources.filter((t=>1!==t.id_status_recurso)).map((t=>t.id_recurso)),this.loaded=!0);const e=t.data.usuario;return parseInt(e.segundos_restantes_selecao)<0?(this.stopPollingState(),void this.$emit("timeExpired")):(this.step===this.steps.QUEUE&&null!=e.posicao&&(this.queuePosition=parseInt(e.posicao,10),1===this.queuePosition?this.changePollingRate(this.pollingIntervals.EVERY_5_SECONDS):this.queuePosition<=2&&this.changePollingRate(this.pollingIntervals.EVERY_10_SECONDS)),1===e.minha_vez&&this.step===this.steps.QUEUE&&null!=e.limite_mesas?(this.startSelectionStep(),this.tableLimit=parseInt(e.limite_mesas,10),this.remainingSeconds=e.segundos_restantes_selecao,this.$nextTick((()=>{this.$refs.timer.startTimer()})),void this.$toasted.success("Chegou sua vez na fila! Por favor selecione suas mesas.",{position:"top-center"})):void(1===e.minha_vez&&this.step===this.steps.SELECTION&&(this.remainingSeconds=e.segundos_restantes_selecao,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error('Atenção! Você tem menos de um minuto para terminar de selecionar suas mesas. Termine a seleção e clique em "Comprar mesas" dentro do tempo limite para garantir suas mesas.',{position:"top-center",duration:8e3}),this.shownAlert=!0),this.$nextTick((()=>{this.$refs.timer.startTimer()})))))},startSelectionStep:function(){this.step=this.steps.SELECTION,this.changePollingRate(this.pollingIntervals.EVERY_5_SECONDS)},requestPickedResources:async function(){if(!this.getMySelectedResourceIds.length)return void this.$toasted.error("É necessário escolher ao menos uma mesa",{position:"top-center"});let t;this.buttonLoading=!0;try{t=await this.$axios.post("/resource/request",{resource_ids:this.getMySelectedResourceIds})}catch(e){return console.error(e),void this.$toasted.error("Não foi possível solicitar os recursos",{position:"top-center"})}finally{this.buttonLoading=!1}this.stopPollingState(),this.$emit("next",t)},getResourceState:function(t){return 4===t.id_status_recurso&&t.solicitado_por_mim?4:1===t.id_status_recurso||t.solicitado_por_mim?this.step===this.steps.QUEUE?1:this.resourceLimitReached&&-1===this.selected.findIndex((e=>e===t.id_recurso))?2:0:3},getItemStyle:function(t){return null==t.row_start||null==t.row_end||null==t.column_start||null==t.column_end?null:{"grid-row":t.row_start+1+" / span "+(t.row_end-t.row_start+1),"grid-column":t.column_start+" / span "+(t.column_end-t.column_start+1)}},atTimerEnd:function(){this.stopPollingState(),this.timeout=window.setTimeout(this.getState,1e3)}}},nt=ot,rt=(0,b.A)(nt,J,H,!1,null,"72925501",null),lt=rt.exports,ct=function(){var t=this,e=t._self._c;return e(p.A,{staticClass:"d-flex justify-center",attrs:{fluid:"","fill-height":""}},[t.loaded?e(m.A,{staticClass:"payment-card"},[e(h.ri,[e(j.A,{attrs:{justify:"center",align:"center"}},[null!=t.payment_value?e(O.A,{staticClass:"keep-words"},[t._v(" Pague R$"+t._s(t.payment_value.toFixed(2))+" via PIX ")]):t._e(),null!=t.remainingSeconds?e(O.A,[e("countdown-timer",{ref:"timer",attrs:{"initial-time":t.remainingSeconds,message:"Tempo restante"},on:{timerEnd:t.atTimerEnd}})],1):t._e()],1)],1),e(h.OQ,[e("div",{staticClass:"mb-2"},[t._v("Escaneie o código QR:")]),t.qr_code_base64?e(n.A,{attrs:{src:`data:image/png;base64,${t.qr_code_base64}`}}):t._e(),e(M.A,{staticClass:"mb-1"}),e("div",{staticClass:"mb-2"},[t._v("Ou use o código abaixo:")]),e(F.A,{attrs:{id:"textToCopy",readonly:"",value:t.qr_code,"append-icon":"mdi-content-copy"},on:{"click:append":t.copyCode}}),e(j.A,{attrs:{align:"center",justify:"center"}},[e(O.A,{staticStyle:{display:"grid","place-items":"center"},attrs:{cols:"12"}},[e(C.A,{attrs:{color:"primary"},on:{click:t.copyCode}},[t._v("Copiar código")])],1)],1),e(j.A,[e(O.A,[e("p",[t._v("Você será redirecionado automaticamente assim que o pagamento for aprovado.")])])],1)],1)],1):e("FullscreenLoader")],1)},dt=[],ut={name:"PaymentStep",components:{CountdownTimer:R,FullscreenLoader:T},data:function(){return{qr_code:null,qr_code_base64:null,payment_value:null,interval:null,remainingSeconds:null,shownAlert:!1,loaded:!1,timeout:null}},mounted:function(){this.loadPayment(),this.startPolling()},beforeDestroy:function(){this.stopPolling(),this.timeout&&window.clearTimeout(this.timeout)},methods:{loadPayment:async function(){try{const t=await this.$axios.post("/payment");if(t.data.pagamento){const{qr_code:e,qr_code_base64:i,valor:a}=t.data.pagamento;this.qr_code=e,this.qr_code_base64=i,this.payment_value=Number(a),this.loaded=!0}}catch(t){this.$toasted.error("Erro ao carregar pagamento. Por favor recarregue a página em instantes")}},startPolling:function(){this.interval||(this.getState(),this.interval=window.setInterval(this.getState,5e3))},stopPolling:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null)},getState:async function(){let t;try{t=await this.$axios.post("/state")}catch(i){return console.error(i),void this.$toasted.error("Não foi possível consultar a fila")}const e=t.data.usuario;return 4===e.id_etapa?(this.stopPolling(),void this.$emit("next")):parseInt(e.segundos_restantes_pagamento,10)<0?(this.stopPolling(),void this.$emit("timeExpired")):(this.remainingSeconds=e.segundos_restantes_pagamento,!this.shownAlert&&parseInt(this.remainingSeconds,10)<=60&&(this.$toasted.error("Atenção! Você tem menos de um minuto para realizar o pagamento. Realize o pagamento dentro do tempo limite para garantir suas mesas.",{duration:8e3}),this.shownAlert=!0),void this.$nextTick((()=>{this.$refs.timer?this.$refs.timer.startTimer():window.setTimeout(this.startTimer,1e3)})))},copyCode:async function(){try{let t=document.querySelector("#textToCopy");t.select(),document.execCommand("copy"),this.$toasted.success("Código copiado!")}catch(t){console.error(t),this.$toasted.error("Não foi possível copiar o código")}},startTimer:function(){this.$refs.timer&&this.$refs.timer.startTimer()},atTimerEnd:function(){this.stopPolling(),this.timeout=window.setTimeout(this.getState,1e3)}}},mt=ut,ht=(0,b.A)(mt,ct,dt,!1,null,"27999c4e",null),pt=ht.exports,ft=function(){var t=this,e=t._self._c;return e(p.A,{staticClass:"d-flex justify-center",attrs:{fluid:"","fill-height":""}},[t.bookedResources.length?t._e():e("FullscreenLoader"),e(m.A,{staticStyle:{width:"100%"},attrs:{"max-width":"500"}},[e(h.ri,[t._v(" Compra finalizada ")]),e(h.OQ,[e("p",[t._v(t._s(t.getBookedResourcesText))])]),e(h.SL,[e(l.A),e(C.A,{attrs:{color:"primary"},on:{click:t.buyMore}},[t._v("Comprar mais mesas")])],1)],1)],1)},gt=[],vt={name:"PurchaseFinished",components:{FullscreenLoader:T},data:function(){return{bookedResources:[],headers:[{text:"Nome",value:"nome_recurso"}]}},computed:{getBookedResourcesText:function(){return this.bookedResources.length>1?"Mesas reservadas para você: "+this.bookedResources.map((t=>t.nome_recurso_short)).join(", "):"Mesa reservada para você: "+this.bookedResources.map((t=>t.nome_recurso_short)).join(", ")}},mounted:function(){this.loadBookedResources()},methods:{loadBookedResources:async function(){const t=await this.$axios.post("/resource/booked");t.data.recursos&&t.data.recursos.length?this.bookedResources=t.data.recursos:window.setTimeout(this.loadBookedResources,1e3)},buyMore:function(){this.$emit("restart")}}},_t=vt,St=(0,b.A)(_t,ft,gt,!1,null,null,null),yt=St.exports,At=function(){var t=this,e=t._self._c;return e(p.A,{staticClass:"d-flex justify-center",attrs:{fluid:"","fill-height":""}},[e(m.A,{staticStyle:{width:"100%"},attrs:{"max-width":"500"}},[e(h.ri,[t._v(" Tempo expirado! ")]),e(h.OQ,[e("p",[t._v(t._s(t.getMessage))])]),e(h.SL,[e(l.A),e(C.A,{attrs:{color:"primary"},on:{click:t.buyMore}},[t._v("Voltar para comprar mesas")])],1)],1)],1)},bt=[],Et={name:"TimeExpired",data:function(){return{steps:{REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6}}},props:{step:{type:Number,required:!0}},computed:{getMessage:function(){return this.step===this.steps.SELECTION_EXPIRED?"O tempo para escolher as mesas expirou. Você pode clicar no botão abaixo para voltar para a fila novamente.":this.step===this.steps.PAYMENT_EXPIRED?"O tempo para pagamento expirou. Você pode clicar no botão abaixo para voltar para a fila novamente.":null}},methods:{buyMore:function(){this.$emit("restart")}}},Tt=Et,Ct=(0,b.A)(Tt,At,bt,!1,null,null,null),xt=Ct.exports,kt={name:"App",components:{StartWaiting:L,StartForm:G,ResourceList:lt,PaymentStep:pt,PurchaseFinished:yt,TimeExpired:xt},data:()=>({steps:{START_WAITING:-1,REGISTER:0,QUEUE:1,SELECTION:2,PAYMENT:3,PAID:4,SELECTION_EXPIRED:5,PAYMENT_EXPIRED:6},step:-1,restart:!1}),methods:{handleGotoStep:function(t){this.step=this.steps[Object.keys(this.steps).find((e=>this.steps[e]===t))]},handleRestart:function(){this.step=this.steps.REGISTER,this.restart=!0}}},wt=kt,It=(0,b.A)(wt,d,u,!1,null,null,null),Pt=It.exports,Rt=i(5868);a.Ay.use(Rt.A);var $t=new Rt.A({theme:{themes:{light:{primary:"#000084",secondary:"#e6e998",accent:"#d82621",error:"#d82621",background:"#fafafa"}}}}),Dt=i(5160),Nt=i.n(Dt),Lt=i(4335);const Ot=Lt.A.create({baseURL:"https://leme.ngrok.app",timeout:1e4,headers:{"Content-Type":"application/json"}});Ot.interceptors.request.use((t=>(t.headers["X-User-Uuid"]=localStorage.getItem("uuid_usuario"),t.headers["Authorization"]=localStorage.getItem("token"),t)));var qt=Ot,Mt=i(9928),Vt=i.n(Mt);a.Ay.config.productionTip=!1,a.Ay.prototype.$axios=qt,a.Ay.use(Nt(),{position:"bottom-center",duration:3e3,theme:"toasted-primary"}),a.Ay.use(Vt()),new a.Ay({vuetify:$t,render:t=>t(Pt)}).$mount("#app")}},e={};function i(a){var s=e[a];if(void 0!==s)return s.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,i),o.exports}i.m=t,function(){var t=[];i.O=function(e,a,s,o){if(!a){var n=1/0;for(d=0;d<t.length;d++){a=t[d][0],s=t[d][1],o=t[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&o||n>=o)&&Object.keys(i.O).every((function(t){return i.O[t](a[l])}))?a.splice(l--,1):(r=!1,o<n&&(n=o));if(r){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[a,s,o]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.p="/lemefest_test/"}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,o,n=a[0],r=a[1],l=a[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(l)var d=l(i)}for(e&&e(a);c<n.length;c++)o=n[c],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(d)},a=self["webpackChunklemefest"]=self["webpackChunklemefest"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=i.O(void 0,[504],(function(){return i(6797)}));a=i.O(a)})();
//# sourceMappingURL=app.e350ea43.js.map